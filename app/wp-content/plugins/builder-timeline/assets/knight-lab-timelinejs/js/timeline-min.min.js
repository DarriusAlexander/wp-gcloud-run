function trace(a){VMM.debug&&(window.console?console.log(a):typeof jsTrace!="undefined"&&jsTrace.send(a))}function onYouTubePlayerAPIReady(){trace("GLOBAL YOUTUBE API CALLED");VMM.ExternalAPI.youtube.onAPIReady()}(function(){var b=!1,a=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(g){function f(){!b&&this.init&&this.init.apply(this,arguments)}var e=this.prototype;b=!0;var c=new this;b=!1;for(var d in g){c[d]=typeof g[d]=="function"&&typeof e[d]=="function"&&a.test(g[d])?function(j,h){return function(){var l=this._super;this._super=e[j];var k=h.apply(this,arguments);this._super=l;return k}}(d,g[d]):g[d]}f.prototype=c;f.prototype.constructor=f;f.extend=arguments.callee;return f}})();var global=function(){return this||(1,eval)("this")}();if(typeof VMM=="undefined"){var VMM=Class.extend({});VMM.debug=!0;VMM.master_config={init:function(){return this},sizes:{api:{width:0,height:0}},vp:"Pellentesque nibh felis, eleifend id, commodo in, interdum vitae, leo",api_keys_master:{flickr:"RAIvxHY4hE/Elm5cieh4X5ptMyDpj7MYIxziGxi0WGCcy1s+yr7rKQ==",google:"uQKadH1VMlCsp560gN2aOiMz4evWkl1s34yryl3F/9FJOsn+/948CbBUvKLN46U=",twitter:""},timers:{api:7000},api:{pushques:[]},twitter:{active:!1,array:[],api_loaded:!1,que:[]},flickr:{active:!1,array:[],api_loaded:!1,que:[]},youtube:{active:!1,array:[],api_loaded:!1,que:[]},vimeo:{active:!1,array:[],api_loaded:!1,que:[]},vine:{active:!1,array:[],api_loaded:!1,que:[]},webthumb:{active:!1,array:[],api_loaded:!1,que:[]},googlemaps:{active:!1,map_active:!1,places_active:!1,array:[],api_loaded:!1,que:[]},googledocs:{active:!1,array:[],api_loaded:!1,que:[]},googleplus:{active:!1,array:[],api_loaded:!1,que:[]},wikipedia:{active:!1,array:[],api_loaded:!1,que:[],tries:0},soundcloud:{active:!1,array:[],api_loaded:!1,que:[]}}.init();VMM.createElement=function(f,b,g,d,a){var c="";if(f!=null&&f!=""){c+="<"+f;g!=null&&g!=""&&(c+=" class='"+g+"'");d!=null&&d!=""&&(c+=" "+d);a!=null&&a!=""&&(c+=" style='"+a+"'");c+=">";b!=null&&b!=""&&(c+=b);c=c+"</"+f+">"}return c};VMM.createMediaElement=function(d,b,f){var c="",a=!1;c+="<div class='media'>";if(d!=null&&d!=""){valid=!0;c+="<img src='"+d+"'>";f!=null&&f!=""&&(c+=VMM.createElement("div",f,"credit"));b!=null&&b!=""&&(c+=VMM.createElement("div",b,"caption"))}c+="</div>";return c};VMM.hideUrlBar=function(){var c=window,a=c.document;if(!location.hash||!c.addEventListener){window.scrollTo(0,1);var d=1,b=setInterval(function(){if(a.body){clearInterval(b);d="scrollTop" in a.body?a.body.scrollTop:1;c.scrollTo(0,d===1?0:1)}},15);c.addEventListener("load",function(){setTimeout(function(){c.scrollTo(0,d===1?0:1)},0)},!1)}}}Date.prototype.getWeek=function(){var a=new Date(this.getFullYear(),0,1);return Math.ceil(((this-a)/86400000+a.getDay()+1)/7)};Date.prototype.getDayOfYear=function(){var a=new Date(this.getFullYear(),0,1);return Math.ceil((this-a)/86400000)};var is={Null:function(a){return a===null},Undefined:function(a){return a===undefined},nt:function(a){return a===null||a===undefined},Function:function(a){return typeof a=="function"?a.constructor.toString().match(/Function/)!==null:!1},String:function(a){return typeof a=="string"?!0:typeof a=="object"?a.constructor.toString().match(/string/i)!==null:!1},Array:function(a){return typeof a=="object"?a.constructor.toString().match(/array/i)!==null||a.length!==undefined:!1},Boolean:function(a){return typeof a=="boolean"?!0:typeof a=="object"?a.constructor.toString().match(/boolean/i)!==null:!1},Date:function(a){return typeof a=="date"?!0:typeof a=="object"?a.constructor.toString().match(/date/i)!==null:!1},HTML:function(a){return typeof a=="object"?a.constructor.toString().match(/html/i)!==null:!1},Number:function(a){return typeof a=="number"?!0:typeof a=="object"?a.constructor.toString().match(/Number/)!==null:!1},Object:function(a){return typeof a=="object"?a.constructor.toString().match(/object/i)!==null:!1},RegExp:function(a){return typeof a=="function"?a.constructor.toString().match(/regexp/i)!==null:!1}},type={of:function(b){for(var a in is){if(is[a](b)){return a.toLowerCase()}}}};if(typeof VMM!="undefined"){VMM.smoothScrollTo=function(d,b,f){if(typeof jQuery!="undefined"){var c="easein",a=1000;b!=null&&(b<1?a=1:a=Math.round(b));f!=null&&f!=""&&(c=f);jQuery(window).scrollTop()!=VMM.Lib.offset(d).top&&VMM.Lib.animate("html,body",a,c,{scrollTop:VMM.Lib.offset(d).top})}};VMM.attachElement=function(b,a){typeof jQuery!="undefined"&&jQuery(b).html(a)};VMM.appendElement=function(b,a){typeof jQuery!="undefined"&&jQuery(b).append(a)};VMM.getHTML=function(b){var a;if(typeof jQuery!="undefined"){a=jQuery(b).html();return a}};VMM.getElement=function(b,a){var c;if(typeof jQuery!="undefined"){a?c=jQuery(b).parent().get(0):c=jQuery(b).get(0);return c}};VMM.bindEvent=function(f,b,h,d){var a,c="click",g={};h!=null&&h!=""&&(c=h);g!=null&&g!=""&&(g=d);typeof jQuery!="undefined"&&jQuery(f).bind(c,g,b)};VMM.unbindEvent=function(f,b,g){var d,a="click",c={};g!=null&&g!=""&&(a=g);typeof jQuery!="undefined"&&jQuery(f).unbind(a,b)};VMM.fireEvent=function(f,b,g){var d,a="click",c=[];b!=null&&b!=""&&(a=b);g!=null&&g!=""&&(c=g);typeof jQuery!="undefined"&&jQuery(f).trigger(a,c)};VMM.getJSON=function(c,a,d){if(typeof jQuery!="undefined"){jQuery.ajaxSetup({timeout:3000});if(VMM.Browser.browser=="Explorer"&&parseInt(VMM.Browser.version,10)>=7&&window.XDomainRequest){trace("IE JSON");var b=c;if(b.match("^http://")){return jQuery.getJSON(b,a,d)}if(b.match("^https://")){b=b.replace("https://","http://");return jQuery.getJSON(b,a,d)}return jQuery.getJSON(c,a,d)}return jQuery.getJSON(c,a,d)}};VMM.parseJSON=function(a){if(typeof jQuery!="undefined"){return jQuery.parseJSON(a)}};VMM.appendAndGetElement=function(g,k,d,b){var f,l="<div>",c="",j="",h="";k!=null&&k!=""&&(l=k);d!=null&&d!=""&&(c=d);b!=null&&b!=""&&(j=b);if(typeof jQuery!="undefined"){f=jQuery(k);f.addClass(c);f.html(j);jQuery(g).append(f)}return f};VMM.Lib={init:function(){return this},hide:function(b,a){a!=null&&a!=""?typeof jQuery!="undefined"&&jQuery(b).hide(a):typeof jQuery!="undefined"&&jQuery(b).hide()},remove:function(a){typeof jQuery!="undefined"&&jQuery(a).remove()},detach:function(a){typeof jQuery!="undefined"&&jQuery(a).detach()},append:function(b,a){typeof jQuery!="undefined"&&jQuery(b).append(a)},prepend:function(b,a){typeof jQuery!="undefined"&&jQuery(b).prepend(a)},show:function(b,a){a!=null&&a!=""?typeof jQuery!="undefined"&&jQuery(b).show(a):typeof jQuery!="undefined"&&jQuery(b).show()},load:function(c,a,d){var b={elem:c};b!=null&&b!=""&&(b=d);typeof jQuery!="undefined"&&jQuery(c).load(b,a)},addClass:function(b,a){typeof jQuery!="undefined"&&jQuery(b).addClass(a)},removeClass:function(b,a){typeof jQuery!="undefined"&&jQuery(b).removeClass(a)},attr:function(b,a,c){if(c!=null&&c!=""){typeof jQuery!="undefined"&&jQuery(b).attr(a,c)}else{if(typeof jQuery!="undefined"){return jQuery(b).attr(a)}}},prop:function(b,a,c){typeof jQuery=="undefined"||!/[1-9]\.[3-9].[1-9]/.test(jQuery.fn.jquery)?VMM.Lib.attribute(b,a,c):jQuery(b).prop(a,c)},attribute:function(b,a,c){if(c!=null&&c!=""){typeof jQuery!="undefined"&&jQuery(b).attr(a,c)}else{if(typeof jQuery!="undefined"){return jQuery(b).attr(a)}}},visible:function(b,a){if(a!=null){typeof jQuery!="undefined"&&(a?jQuery(b).show(0):jQuery(b).hide(0))}else{if(typeof jQuery!="undefined"){return jQuery(b).is(":visible")?!0:!1}}},css:function(b,a,c){if(c!=null&&c!=""){typeof jQuery!="undefined"&&jQuery(b).css(a,c)}else{if(typeof jQuery!="undefined"){return jQuery(b).css(a)}}},cssmultiple:function(b,a){if(typeof jQuery!="undefined"){return jQuery(b).css(a)}},offset:function(b){var a;typeof jQuery!="undefined"&&(a=jQuery(b).offset());return a},position:function(b){var a;typeof jQuery!="undefined"&&(a=jQuery(b).position());return a},width:function(b,a){if(a!=null&&a!=""){typeof jQuery!="undefined"&&jQuery(b).width(a)}else{if(typeof jQuery!="undefined"){return jQuery(b).width()}}},height:function(b,a){if(a!=null&&a!=""){typeof jQuery!="undefined"&&jQuery(b).height(a)}else{if(typeof jQuery!="undefined"){return jQuery(b).height()}}},toggleClass:function(b,a){typeof jQuery!="undefined"&&jQuery(b).toggleClass(a)},each:function(b,a){typeof jQuery!="undefined"&&jQuery(b).each(a)},html:function(b,a){var c;if(typeof jQuery!="undefined"){c=jQuery(b).html();return c}if(a!=null&&a!=""){typeof jQuery!="undefined"&&jQuery(b).html(a)}else{var c;if(typeof jQuery!="undefined"){c=jQuery(b).html();return c}}},find:function(b,a){if(typeof jQuery!="undefined"){return jQuery(b).find(a)}},stop:function(a){typeof jQuery!="undefined"&&jQuery(a).stop()},delay_animate:function(g,c,j,f,b,d){if(VMM.Browser.device=="mobile"||VMM.Browser.device=="tablet"){var h=Math.round(j/1500*10)/10,a=h+"s";VMM.Lib.css(c,"-webkit-transition","all "+a+" ease");VMM.Lib.css(c,"-moz-transition","all "+a+" ease");VMM.Lib.css(c,"-o-transition","all "+a+" ease");VMM.Lib.css(c,"-ms-transition","all "+a+" ease");VMM.Lib.css(c,"transition","all "+a+" ease");VMM.Lib.cssmultiple(c,_att)}else{typeof jQuery!="undefined"&&jQuery(c).delay(g).animate(b,{duration:j,easing:f})}},animate:function(m,w,g,b,j,y){var d="easein",v=!1,q=1000,k={};w!=null&&(w<1?q=1:q=Math.round(w));g!=null&&g!=""&&(d=g);j!=null&&j!=""&&(v=j);b!=null?k=b:k={opacity:0};if(VMM.Browser.device=="mobile"||VMM.Browser.device=="tablet"){var h=Math.round(q/1500*10)/10,p=h+"s";d=" cubic-bezier(0.33, 0.66, 0.66, 1)";for(x in k){if(Object.prototype.hasOwnProperty.call(k,x)){trace(x+" to "+k[x]);VMM.Lib.css(m,"-webkit-transition",x+" "+p+d);VMM.Lib.css(m,"-moz-transition",x+" "+p+d);VMM.Lib.css(m,"-o-transition",x+" "+p+d);VMM.Lib.css(m,"-ms-transition",x+" "+p+d);VMM.Lib.css(m,"transition",x+" "+p+d)}}VMM.Lib.cssmultiple(m,k)}else{typeof jQuery!="undefined"&&(y!=null&&y!=""?jQuery(m).animate(k,{queue:v,duration:q,easing:d,complete:y}):jQuery(m).animate(k,{queue:v,duration:q,easing:d}))}}}}if(typeof jQuery!="undefined"){(function(a){window.XDomainRequest&&a.ajaxTransport(function(b){if(b.crossDomain&&b.async){if(b.timeout){b.xdrTimeout=b.timeout;delete b.timeout}var c;return{send:function(e,d){function f(g,j,h,k){c.onload=c.onerror=c.ontimeout=a.noop;c=undefined;d(g,j,h,k)}c=new XDomainRequest;c.open(b.type,b.url);c.onload=function(){f(200,"OK",{text:c.responseText},"Content-Type: "+c.contentType)};c.onerror=function(){f(404,"Not Found")};if(b.xdrTimeout){c.ontimeout=function(){f(0,"timeout")};c.timeout=b.xdrTimeout}c.send(b.hasContent&&b.data||null)},abort:function(){if(c){c.onerror=a.noop();c.abort()}}}}})})(jQuery);jQuery.easing.jswing=jQuery.easing.swing;jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(d,b,f,c,a){return jQuery.easing[jQuery.easing.def](d,b,f,c,a)},easeInExpo:function(d,b,f,c,a){return b==0?f:c*Math.pow(2,10*(b/a-1))+f},easeOutExpo:function(d,b,f,c,a){return b==a?f+c:c*(-Math.pow(2,-10*b/a)+1)+f},easeInOutExpo:function(d,b,f,c,a){return b==0?f:b==a?f+c:(b/=a/2)<1?c/2*Math.pow(2,10*(b-1))+f:c/2*(-Math.pow(2,-10*--b)+2)+f},easeInQuad:function(d,b,f,c,a){return c*(b/=a)*b+f},easeOutQuad:function(d,b,f,c,a){return -c*(b/=a)*(b-2)+f},easeInOutQuad:function(d,b,f,c,a){return(b/=a/2)<1?c/2*b*b+f:-c/2*(--b*(b-2)-1)+f}})}if(typeof VMM!="undefined"&&typeof VMM.Browser=="undefined"){VMM.Browser={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.tridentVersion=this.searchTridentVersion(navigator.userAgent);this.OS=this.searchString(this.dataOS)||"an unknown OS";this.device=this.searchDevice(navigator.userAgent);this.orientation=this.searchOrientation(window.orientation)},searchOrientation:function(b){var a="";b==0||b==180?a="portrait":b==90||b==-90?a="landscape":a="normal";return a},searchDevice:function(b){var a="";b.match(/Android/i)||b.match(/iPhone|iPod/i)?a="mobile":b.match(/iPad/i)?a="tablet":b.match(/BlackBerry/i)||b.match(/IEMobile/i)?a="other mobile":a="desktop";return a},searchString:function(c){for(var a=0;a<c.length;a++){var d=c[a].string,b=c[a].prop;this.versionSearchString=c[a].versionSearch||c[a].identity;if(d){if(d.indexOf(c[a].subString)!=-1){return c[a].identity}}else{if(b){return c[a].identity}}}},searchVersion:function(b){var a=b.indexOf(this.versionSearchString);if(a==-1){return}return parseFloat(b.substring(a+this.versionSearchString.length+1))},searchTridentVersion:function(b){var a=b.indexOf("Trident/");return a==-1?0:parseFloat(b.substring(a+8))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.userAgent,subString:"iPad",identity:"iPad"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};VMM.Browser.init()}typeof VMM!="undefined"&&typeof VMM.FileExtention=="undefined"&&(VMM.FileExtention={googleDocType:function(f){var b=f.replace(/\s\s*$/,""),g="",d=["DOC","DOCX","XLS","XLSX","PPT","PPTX","PDF","PAGES","AI","PSD","TIFF","DXF","SVG","EPS","PS","TTF","XPS","ZIP","RAR"],a=!1;g=b.substr(b.length-5,5);for(var c=0;c<d.length;c++){if(g.toLowerCase().match(d[c].toString().toLowerCase())||b.match("docs.google.com")){a=!0}}return a}});if(typeof VMM!="undefined"&&typeof VMM.Date=="undefined"){VMM.Date={init:function(){return this},dateformats:{year:"yyyy",month_short:"mmm",month:"mmmm yyyy",full_short:"mmm d",full:"mmmm d',' yyyy",time_short:"h:MM:ss TT",time_no_seconds_short:"h:MM TT",time_no_seconds_small_date:"h:MM TT'<br/><small>'mmmm d',' yyyy'</small>'",full_long:"mmm d',' yyyy 'at' hh:MM TT",full_long_small_date:"hh:MM TT'<br/><small>mmm d',' yyyy'</small>'"},month:["January","February","March","April","May","June","July","August","September","October","November","December"],month_abbr:["Jan.","Feb.","March","April","May","June","July","Aug.","Sept.","Oct.","Nov.","Dec."],day:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],day_abbr:["Sun.","Mon.","Tues.","Wed.","Thurs.","Fri.","Sat."],hour:[1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,12],hour_suffix:["am"],bc_format:{year:"yyyy",month_short:"mmm",month:"mmmm yyyy",full_short:"mmm d",full:"mmmm d',' yyyy",time_no_seconds_short:"h:MM TT",time_no_seconds_small_date:"dddd', 'h:MM TT'<br/><small>'mmmm d',' yyyy'</small>'",full_long:"dddd',' mmm d',' yyyy 'at' hh:MM TT",full_long_small_date:"hh:MM TT'<br/><small>'dddd',' mmm d',' yyyy'</small>'"},setLanguage:function(a){trace("SET DATE LANGUAGE");VMM.Date.dateformats=a.dateformats;VMM.Date.month=a.date.month;VMM.Date.month_abbr=a.date.month_abbr;VMM.Date.day=a.date.day;VMM.Date.day_abbr=a.date.day_abbr;dateFormat.i18n.dayNames=a.date.day_abbr.concat(a.date.day);dateFormat.i18n.monthNames=a.date.month_abbr.concat(a.date.month)},parse:function(g,k){var d,b,f,l,c={year:!1,month:!1,day:!1,hour:!1,minute:!1,second:!1,millisecond:!1};if(type.of(g)=="date"){trace("DEBUG THIS, ITs A DATE");d=g}else{d=new Date(0,0,1,0,0,0,0);if(g.match(/,/gi)){b=g.split(",");for(var j=0;j<b.length;j++){b[j]=parseInt(b[j],10)}if(b[0]){d.setFullYear(b[0]);c.year=!0}if(b[1]){d.setMonth(b[1]-1);c.month=!0}if(b[2]){d.setDate(b[2]);c.day=!0}if(b[3]){d.setHours(b[3]);c.hour=!0}if(b[4]){d.setMinutes(b[4]);c.minute=!0}if(b[5]){d.setSeconds(b[5]);b[5]>=1&&(c.second=!0)}if(b[6]){d.setMilliseconds(b[6]);b[6]>=1&&(c.millisecond=!0)}}else{if(g.match("/")){if(g.match(" ")){l=g.split(" ");if(g.match(":")){f=l[1].split(":");if(f[0]>=0){d.setHours(f[0]);c.hour=!0}if(f[1]>=0){d.setMinutes(f[1]);c.minute=!0}if(f[2]>=0){d.setSeconds(f[2]);c.second=!0}if(f[3]>=0){d.setMilliseconds(f[3]);c.millisecond=!0}}b=l[0].split("/")}else{b=g.split("/")}if(b[2]){d.setFullYear(b[2]);c.year=!0}if(b[0]>=0){d.setMonth(b[0]-1);c.month=!0}if(b[1]>=0){if(b[1].length>2){d.setFullYear(b[1]);c.year=!0}else{d.setDate(b[1]);c.day=!0}}}else{if(g.match("now")){var h=new Date;d.setFullYear(h.getFullYear());c.year=!0;d.setMonth(h.getMonth());c.month=!0;d.setDate(h.getDate());c.day=!0;if(g.match("hours")){d.setHours(h.getHours());c.hour=!0}if(g.match("minutes")){d.setHours(h.getHours());d.setMinutes(h.getMinutes());c.hour=!0;c.minute=!0}if(g.match("seconds")){d.setHours(h.getHours());d.setMinutes(h.getMinutes());d.setSeconds(h.getSeconds());c.hour=!0;c.minute=!0;c.second=!0}if(g.match("milliseconds")){d.setHours(h.getHours());d.setMinutes(h.getMinutes());d.setSeconds(h.getSeconds());d.setMilliseconds(h.getMilliseconds());c.hour=!0;c.minute=!0;c.second=!0;c.millisecond=!0}}else{if(g.length<=8){c.year=!0;d.setFullYear(parseInt(g,10));d.setMonth(0);d.setDate(1);d.setHours(0);d.setMinutes(0);d.setSeconds(0);d.setMilliseconds(0)}else{if(g.match("T")){if(navigator.userAgent.match(/MSIE\s(?!9.0)/)){l=g.split("T");if(g.match(":")){f=l[1].split(":");if(f[0]>=1){d.setHours(f[0]);c.hour=!0}if(f[1]>=1){d.setMinutes(f[1]);c.minute=!0}if(f[2]>=1){d.setSeconds(f[2]);f[2]>=1&&(c.second=!0)}if(f[3]>=1){d.setMilliseconds(f[3]);f[3]>=1&&(c.millisecond=!0)}}b=l[0].split("-");if(b[0]){d.setFullYear(b[0]);c.year=!0}if(b[1]>=0){d.setMonth(b[1]-1);c.month=!0}if(b[2]>=0){d.setDate(b[2]);c.day=!0}}else{d=new Date(Date.parse(g));c.year=!0;c.month=!0;c.day=!0;c.hour=!0;c.minute=!0;d.getSeconds()>=1&&(c.second=!0);d.getMilliseconds()>=1&&(c.millisecond=!0)}}else{d=new Date(parseInt(g.slice(0,4),10),parseInt(g.slice(4,6),10)-1,parseInt(g.slice(6,8),10),parseInt(g.slice(8,10),10),parseInt(g.slice(10,12),10));c.year=!0;c.month=!0;c.day=!0;c.hour=!0;c.minute=!0;d.getSeconds()>=1&&(c.second=!0);d.getMilliseconds()>=1&&(c.millisecond=!0)}}}}}}return k!=null&&k!=""?{date:d,precision:c}:d},prettyDate:function(w,B,j,b){var m,C,g,A,z=!1,v,k,y;if(b!=null&&b!=""&&typeof b!="undefined"){z=!0;trace("D2 "+b)}if(type.of(w)=="date"){type.of(j)=="object"?j.millisecond||j.second&&w.getSeconds()>=1?B?g=VMM.Date.dateformats.time_short:g=VMM.Date.dateformats.time_short:j.minute?B?g=VMM.Date.dateformats.time_no_seconds_short:g=VMM.Date.dateformats.time_no_seconds_small_date:j.hour?B?g=VMM.Date.dateformats.time_no_seconds_short:g=VMM.Date.dateformats.time_no_seconds_small_date:j.day?B?g=VMM.Date.dateformats.full_short:g=VMM.Date.dateformats.full:j.month?B?g=VMM.Date.dateformats.month_short:g=VMM.Date.dateformats.month:j.year?g=VMM.Date.dateformats.year:g=VMM.Date.dateformats.year:w.getMonth()===0&&w.getDate()==1&&w.getHours()===0&&w.getMinutes()===0?g=VMM.Date.dateformats.year:w.getDate()<=1&&w.getHours()===0&&w.getMinutes()===0?B?g=VMM.Date.dateformats.month_short:g=VMM.Date.dateformats.month:w.getHours()===0&&w.getMinutes()===0?B?g=VMM.Date.dateformats.full_short:g=VMM.Date.dateformats.full:w.getMinutes()===0?B?g=VMM.Date.dateformats.time_no_seconds_short:g=VMM.Date.dateformats.time_no_seconds_small_date:B?g=VMM.Date.dateformats.time_no_seconds_short:g=VMM.Date.dateformats.full_long;m=dateFormat(w,g,!1);A=m.split(" ");for(var q=0;q<A.length;q++){if(parseInt(A[q],10)<0){trace("YEAR IS BC");v=A[q];k=Math.abs(parseInt(A[q],10));y=k.toString()+" B.C.";m=m.replace(v,y)}}if(z){C=dateFormat(b,g,!1);A=C.split(" ");for(var d=0;d<A.length;d++){if(parseInt(A[d],10)<0){trace("YEAR IS BC");v=A[d];k=Math.abs(parseInt(A[d],10));y=k.toString()+" B.C.";C=C.replace(v,y)}}}}else{trace("NOT A VALID DATE?");trace(w)}return z?m+" &mdash; "+C:m}}.init();var dateFormat=function(){var c=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[WLloSZ]|"[^"]*"|'[^']*'/g,a=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,d=/[^-+\dA-Z]/g,b=function(g,f){g=String(g);f=f||2;while(g.length<f){g="0"+g}return g};return function(q,G,j){var F=dateFormat;if(arguments.length==1&&Object.prototype.toString.call(q)=="[object String]"&&!/\d/.test(q)){G=q;q=undefined}isNaN(q)&&trace("invalid date "+q);G=String(F.masks[G]||G||F.masks["default"]);if(G.slice(0,4)=="UTC:"){G=G.slice(4);j=!0}var D=j?"getUTC":"get",w=q[D+"Date"](),n=q[D+"Day"](),A=q[D+"Month"](),r=q[D+"FullYear"](),e=q[D+"Hours"](),z=q[D+"Minutes"](),E=q[D+"Seconds"](),k=q[D+"Milliseconds"](),t=q.getWeek(),C=j?0:q.getTimezoneOffset(),B={d:w,dd:b(w),ddd:F.i18n.dayNames[n],dddd:F.i18n.dayNames[n+7],m:A+1,mm:b(A+1),mmm:F.i18n.monthNames[A],mmmm:F.i18n.monthNames[A+12],yy:String(r).slice(2),yyyy:r,h:e%12||12,hh:b(e%12||12),H:e,HH:b(e),M:z,MM:b(z),s:E,ss:b(E),l:b(k,3),L:b(k>99?Math.round(k/10):k),t:e<12?"a":"p",tt:e<12?"am":"pm",T:e<12?"A":"P",TT:e<12?"AM":"PM",Z:j?"UTC":(String(q).match(a)||[""]).pop().replace(d,""),o:(C>0?"-":"+")+b(Math.floor(Math.abs(C)/60)*100+Math.abs(C)%60,4),S:["th","st","nd","rd"][w%10>3?0:(w%100-w%10!=10)*w%10],W:t};return G.replace(c,function(f){return f in B?B[f]:f.slice(1,f.length-1)})}}();dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"};dateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]};Date.prototype.format=function(b,a){return dateFormat(this,b,a)}}typeof VMM!="undefined"&&typeof VMM.Util=="undefined"&&(VMM.Util={init:function(){return this},removeRange:function(c,a,d){var b=c.slice((d||a)+1||c.length);c.length=a<0?c.length+a:a;return c.push.apply(c,b)},correctProtocol:function(c){var a=window.parent.location.protocol.toString(),d="",b=c.split("://",2);a.match("http")?d=a:d="https";return d+"://"+b[1]},mergeConfig:function(b,a){var c;for(c in a){Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c])}return b},getObjectAttributeByIndex:function(c,a){if(typeof c!="undefined"){var d=0;for(var b in c){if(a===d){return c[b]}d++}return""}return""},ordinal:function(a){return["th","st","nd","rd"][!(a%10>3||Math.floor(a%100/10)==1)*(a%10)]},randomBetween:function(b,a){return Math.floor(Math.random()*(a-b+1)+b)},average:function(f){var b={mean:0,variance:0,deviation:0},g=f.length;for(var d,a=0,c=g;c--;a+=f[c]){}for(d=b.mean=a/g,c=g,a=0;c--;a+=Math.pow(f[c]-d,2)){}return b.deviation=Math.sqrt(b.variance=a/g),b},customSort:function(c,a){var d=c,b=a;return d==b?0:d>b?1:-1},deDupeArray:function(d){var b,f=d.length,c=[],a={};for(b=0;b<f;b++){a[d[b]]=0}for(b in a){c.push(b)}return c},wordCount:function(g){var c=g+" ",j=/^[^A-Za-z0-9\'\-]+/gi,f=c.replace(j,""),b=/[^A-Za-z0-9\'\-]+/gi,d=f.replace(b," "),h=d.split(" "),a=h.length-1;c.length<2&&(a=0);return a},ratio:{fit:function(d,b,f,c){var a={width:0,height:0};a.width=d;a.height=Math.round(d/f*c);if(a.height>b){a.height=b;a.width=Math.round(b/c*f);a.width>d&&trace("FIT: DIDN'T FIT!!! ")}return a},r16_9:function(b,a){if(b!==null&&b!==""){return Math.round(a/16*9)}if(a!==null&&a!==""){return Math.round(b/9*16)}},r4_3:function(b,a){if(b!==null&&b!==""){return Math.round(a/4*3)}if(a!==null&&a!==""){return Math.round(b/3*4)}}},doubledigit:function(a){return(a<10?"0":"")+a},truncateWords:function(j,m,d){m||(m=30);d||(d=m);var b=/^[^A-Za-z0-9\'\-]+/gi,g=j.replace(b,""),p=g.split(" "),c=[];m=Math.min(p.length,m);d=Math.min(p.length,d);for(var l=0;l<m;l++){c.push(p[l])}for(var k=m;l<d;l++){var h=p[l];c.push(h);if(h.charAt(h.length-1)=="."){break}}return c.join(" ")},linkify:function(f,b,g){var d=/\b(?:https?|ftp):\/\/[a-z0-9-+&@#\/%?=~_|!:,.;]*[a-z0-9-+&@#\/%=~_|]/gim,a=/(^|[^\/])(www\.[\S]+(\b|$))/gim,c=/(([a-zA-Z0-9_\-\.]+)@[a-zA-Z_]+?(?:\.[a-zA-Z]{2,6}))+/gim;return f.replace(d,"<a target='_blank' href='$&' onclick='void(0)'>$&</a>").replace(a,"$1<a target='_blank' onclick='void(0)' href='http://$2'>$2</a>").replace(c,"<a target='_blank' onclick='void(0)' href='mailto:$1'>$1</a>")},linkify_with_twitter:function(k,q,d){function p(f){var a=/(\b(https?|ftp|file):\/\/([-A-Z0-9+&@#%?=~_|!:,.;]*)([-A-Z0-9+&@#%?\/=~_|!:,.;]*)[-A-Z0-9+&@#\/%=~_|])/ig;return f.replace(a,"<a href='$1' target='_blank'>$3</a>")}var b=/\b(?:https?|ftp):\/\/[a-z0-9-+&@#\/%?=~_|!:,.;]*[a-z0-9-+&@#\/%=~_|]/gim,h=/(\()((?:ht|f)tps?:\/\/[a-z0-9\-._~!$&'()*+,;=:\/?#[\]@%]+)(\))|(\[)((?:ht|f)tps?:\/\/[a-z0-9\-._~!$&'()*+,;=:\/?#[\]@%]+)(\])|(\{)((?:ht|f)tps?:\/\/[a-z0-9\-._~!$&'()*+,;=:\/?#[\]@%]+)(\})|(<|&(?:lt|#60|#x3c);)((?:ht|f)tps?:\/\/[a-z0-9\-._~!$&'()*+,;=:\/?#[\]@%]+)(>|&(?:gt|#62|#x3e);)|((?:^|[^=\s'"\]])\s*['"]?|[^=\s]\s+)(\b(?:ht|f)tps?:\/\/[a-z0-9\-._~!$'()*+,;=:\/?#[\]@%]+(?:(?!&(?:gt|#0*62|#x0*3e);|&(?:amp|apos|quot|#0*3[49]|#x0*2[27]);[.!&',:?;]?(?:[^a-z0-9\-._~!$&'()*+,;=:\/?#[\]@%]|$))&[a-z0-9\-._~!$'()*+,;=:\/?#[\]@%]*)*[a-z0-9\-_~$()*+=\/#[\]@%])/img,v='$1$4$7$10$13<a href="$2$5$8$11$14" target="_blank" class="hyphenate">$2$5$8$11$14</a>$3$6$9$12',c=/(^|[^\/])(www\.[\S]+(\b|$))/gim,m=/(([a-zA-Z0-9_\-\.]+)@[a-zA-Z_]+?(?:\.[a-zA-Z]{2,6}))+/gim,j=/\B@([\w-]+)/gm,g=/(#([\w]+))/g;return k.replace(h,v).replace(c,"$1<a target='_blank' class='hyphenate' onclick='void(0)' href='http://$2'>$2</a>").replace(m,"<a target='_blank' onclick='void(0)' href='mailto:$1'>$1</a>").replace(j,"<a href='http://twitter.com/$1' target='_blank' onclick='void(0)'>@$1</a>")},linkify_wikipedia:function(b){var a=/<i[^>]*>(.*?)<\/i>/gim;return b.replace(a,"<a target='_blank' href='http://en.wikipedia.org/wiki/$&' onclick='void(0)'>$&</a>").replace(/<i\b[^>]*>/gim,"").replace(/<\/i>/gim,"").replace(/<b\b[^>]*>/gim,"").replace(/<\/b>/gim,"")},unlinkify:function(a){if(!a){return a}a=a.replace(/<a\b[^>]*>/i,"");a=a.replace(/<\/a>/i,"");return a},untagify:function(a){if(!a){return a}a=a.replace(/<\/?\s*\w.*?>/g,"");return a},nl2br:function(a){return a.replace(/(\r\n|[\r\n]|\\n|\\r)/g,"<br/>")},unique_ID:function(c){var a=function(f){return Math.floor(Math.random()*f)},d=function(){var f="abcdefghijklmnopqurstuvwxyzABCDEFGHIJKLMNOPQURSTUVWXYZ";return f.substr(a(62),1)},b=function(h){var f="";for(var g=0;g<h;g++){f+=d()}return f};return b(c)},isEven:function(a){return a%2===0?!0:!1},getUrlVars:function(f){var b=f.toString();b.match("&#038;")?b=b.replace("&#038;","&"):b.match("&#38;")?b=b.replace("&#38;","&"):b.match("&amp;")&&(b=b.replace("&amp;","&"));var g=[],d,a=b.slice(b.indexOf("?")+1).split("&");for(var c=0;c<a.length;c++){d=a[c].split("=");g.push(d[0]);g[d[0]]=d[1]}return g},toHTML:function(a){a=this.nl2br(a);a=this.linkify(a);return a.replace(/\s\s/g,"&nbsp;&nbsp;")},toCamelCase:function(c,a){a!==!1&&(a=!0);var d=(a?c.toLowerCase():c).split(" ");for(var b=0;b<d.length;b++){d[b]=d[b].substr(0,1).toUpperCase()+d[b].substr(1)}return d.join(" ")},properQuotes:function(a){return a.replace(/\"([^\"]*)\"/gi,"&#8220;$1&#8221;")},niceNumber:function(b){b+="";x=b.split(".");x1=x[0];x2=x.length>1?"."+x[1]:"";var a=/(\d+)(\d{3})/;while(a.test(x1)){x1=x1.replace(a,"$1,$2")}return x1+x2},toTitleCase:function(b){if(VMM.Browser.browser=="Explorer"&&parseInt(VMM.Browser.version,10)>=7){return b.replace("_","%20")}var a={__smallWords:["a","an","and","as","at","but","by","en","for","if","in","of","on","or","the","to","v[.]?","via","vs[.]?"],init:function(){this.__smallRE=this.__smallWords.join("|");this.__lowerCaseWordsRE=new RegExp("\\b("+this.__smallRE+")\\b","gi");this.__firstWordRE=new RegExp("^([^a-zA-Z0-9 \\r\\n\\t]*)("+this.__smallRE+")\\b","gi");this.__lastWordRE=new RegExp("\\b("+this.__smallRE+")([^a-zA-Z0-9 \\r\\n\\t]*)$","gi")},toTitleCase:function(g){var d="",h=g.split(/([:.;?!][ ]|(?:[ ]|^)["“])/);for(var f=0;f<h.length;++f){var c=h[f];c=c.replace(/\b([a-zA-Z][a-z.'’]*)\b/g,this.__titleCaseDottedWordReplacer);c=c.replace(this.__lowerCaseWordsRE,this.__lowerReplacer);c=c.replace(this.__firstWordRE,this.__firstToUpperCase);c=c.replace(this.__lastWordRE,this.__firstToUpperCase);d+=c}d=d.replace(/ V(s?)\. /g," v$1. ");d=d.replace(/(['’])S\b/g,"$1s");d=d.replace(/\b(AT&T|Q&A)\b/ig,this.__upperReplacer);return d},__titleCaseDottedWordReplacer:function(c){return c.match(/[a-zA-Z][.][a-zA-Z]/)?c:a.__firstToUpperCase(c)},__lowerReplacer:function(c){return c.toLowerCase()},__upperReplacer:function(c){return c.toUpperCase()},__firstToUpperCase:function(d){var c=d.split(/(^[^a-zA-Z0-9]*[a-zA-Z0-9])(.*)$/);c[1]&&(c[1]=c[1].toUpperCase());return c.join("")}};a.init();b=b.replace(/_/g," ");b=a.toTitleCase(b);return b}}.init());LazyLoad=function(q){function y(c,f){var e=q.createElement(c),a;for(a in f){f.hasOwnProperty(a)&&e.setAttribute(a,f[a])}return e}function w(c){var a=b[c],h,f;if(a){h=a.callback;f=a.urls;f.shift();k=0;if(!f.length){h&&h.call(a.context,a.obj);b[c]=null;A[c].length&&j(c)}}}function p(){var a=navigator.userAgent;z={async:q.createElement("script").async===!0};(z.webkit=/AppleWebKit\//.test(a))||(z.ie=/MSIE/.test(a))||(z.opera=/Opera/.test(a))||(z.gecko=/Gecko\//.test(a))||(z.unknown=!0)}function j(n,c,f,a,s){var D=function(){w(n)},e=n==="css",r=[],u,t,C,F,h,B;z||p();if(c){c=typeof c=="string"?[c]:c.concat();if(e||z.async||z.gecko||z.opera){A[n].push({urls:c,callback:f,obj:a,context:s})}else{for(u=0,t=c.length;u<t;++u){A[n].push({urls:[c[u]],callback:u===t-1?f:null,obj:a,context:s})}}}if(b[n]||!(F=b[n]=A[n].shift())){return}g||(g=q.head||q.getElementsByTagName("head")[0]);h=F.urls;for(u=0,t=h.length;u<t;++u){B=h[u];if(e){C=z.gecko?y("style"):y("link",{href:B,rel:"stylesheet"})}else{C=y("script",{src:B});C.async=!1}C.className="lazyload";C.setAttribute("charset","utf-8");if(z.ie&&!e){C.onreadystatechange=function(){if(/loaded|complete/.test(C.readyState)){C.onreadystatechange=null;D()}}}else{if(e&&(z.gecko||z.webkit)){if(z.webkit){F.urls[u]=C.href;m()}else{C.innerHTML='@import "'+B+'";';v(C)}}else{C.onload=C.onerror=D}}r.push(C)}for(u=0,t=r.length;u<t;++u){g.appendChild(r[u])}}function v(c){var a;try{a=!!c.sheet.cssRules}catch(f){k+=1;k<200?setTimeout(function(){v(c)},50):a&&w("css");return}w("css")}function m(){var c=b.css,a;if(c){a=d.length;while(--a>=0){if(d[a].href===c.urls[0]){w("css");break}}k+=1;c&&(k<200?setTimeout(m,50):w("css"))}}var z,g,b={},k=0,A={css:[],js:[]},d=q.styleSheets;return{css:function(f,a,h,c){j("css",f,a,h,c)},js:function(f,a,h,c){j("js",f,a,h,c)}}}(this.document);LoadLib=function(b){function c(f){var g=0,d=!1;for(g=0;g<a.length;g++){a[g]==f&&(d=!0)}if(d){return !0}a.push(f);return !1}var a=[];return{css:function(h,f,g,d){c(h)||LazyLoad.css(h,f,g,d)},js:function(h,f,g,d){c(h)||LazyLoad.js(h,f,g,d)}}}(this.document);typeof VMM!="undefined"&&typeof VMM.Language=="undefined"&&(VMM.Language={lang:"en",api:{wikipedia:"en"},date:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],month_abbr:["Jan.","Feb.","March","April","May","June","July","Aug.","Sept.","Oct.","Nov.","Dec."],day:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],day_abbr:["Sun.","Mon.","Tues.","Wed.","Thurs.","Fri.","Sat."]},dateformats:{year:"yyyy",month_short:"mmm",month:"mmmm yyyy",full_short:"mmm d",full:"mmmm d',' yyyy",time_short:"h:MM:ss TT",time_no_seconds_short:"h:MM TT",time_no_seconds_small_date:"h:MM TT'<br/><small>'mmmm d',' yyyy'</small>'",full_long:"mmm d',' yyyy 'at' h:MM TT",full_long_small_date:"h:MM TT'<br/><small>mmm d',' yyyy'</small>'"},messages:{loading_timeline:"Loading Timeline... ",return_to_title:"Return to Title",expand_timeline:"Expand Timeline",contract_timeline:"Contract Timeline",wikipedia:"From Wikipedia, the free encyclopedia",loading_content:"Loading Content",loading:"Loading"}});typeof VMM!="undefined"&&typeof VMM.ExternalAPI=="undefined"&&(VMM.ExternalAPI={keys:{google:"",flickr:"",twitter:""},keys_master:{vp:"Pellentesque nibh felis, eleifend id, commodo in, interdum vitae, leo",flickr:"RAIvxHY4hE/Elm5cieh4X5ptMyDpj7MYIxziGxi0WGCcy1s+yr7rKQ==",google:"jwNGnYw4hE9lmAez4ll0QD+jo6SKBJFknkopLS4FrSAuGfIwyj57AusuR0s8dAo=",twitter:""},init:function(){return this},setKeys:function(a){VMM.ExternalAPI.keys=a},pushQues:function(){VMM.master_config.googlemaps.active&&VMM.ExternalAPI.googlemaps.pushQue();VMM.master_config.youtube.active&&VMM.ExternalAPI.youtube.pushQue();VMM.master_config.soundcloud.active&&VMM.ExternalAPI.soundcloud.pushQue();VMM.master_config.googledocs.active&&VMM.ExternalAPI.googledocs.pushQue();VMM.master_config.googleplus.active&&VMM.ExternalAPI.googleplus.pushQue();VMM.master_config.wikipedia.active&&VMM.ExternalAPI.wikipedia.pushQue();VMM.master_config.vimeo.active&&VMM.ExternalAPI.vimeo.pushQue();VMM.master_config.vine.active&&VMM.ExternalAPI.vine.pushQue();VMM.master_config.twitter.active&&VMM.ExternalAPI.twitter.pushQue();VMM.master_config.flickr.active&&VMM.ExternalAPI.flickr.pushQue();VMM.master_config.webthumb.active&&VMM.ExternalAPI.webthumb.pushQue()},twitter:{tweetArray:[],get:function(b){var a={mid:b.id,id:b.uid};VMM.master_config.twitter.que.push(a);VMM.master_config.twitter.active=!0},create:function(d,b){var f=d.mid.toString(),c={twitterid:d.mid},a="//api.twitter.com/1/statuses/show.json?id="+d.mid+"&include_entities=true&callback=?";VMM.ExternalAPI.twitter.getOEmbed(d,b)},errorTimeOut:function(a){trace("TWITTER JSON ERROR TIMEOUT "+a.mid);VMM.attachElement("#"+a.id.toString(),VMM.MediaElement.loadingmessage("Still waiting on Twitter: "+a.mid));VMM.getJSON("//api.twitter.com/1/account/rate_limit_status.json",function(b){trace("REMAINING TWITTER API CALLS "+b.remaining_hits);trace("TWITTER RATE LIMIT WILL RESET AT "+b.reset_time);var c="";if(b.remaining_hits==0){c="<p>You've reached the maximum number of tweets you can load in an hour.</p>";c+="<p>You can view tweets again starting at: <br/>"+b.reset_time+"</p>"}else{c="<p>Still waiting on Twitter. "+a.mid+"</p>"}VMM.attachElement("#"+a.id.toString(),VMM.MediaElement.loadingmessage(c))})},errorTimeOutOembed:function(a){trace("TWITTER JSON ERROR TIMEOUT "+a.mid);VMM.attachElement("#"+a.id.toString(),VMM.MediaElement.loadingmessage("Still waiting on Twitter: "+a.mid))},pushQue:function(){if(VMM.master_config.twitter.que.length>0){VMM.ExternalAPI.twitter.create(VMM.master_config.twitter.que[0],VMM.ExternalAPI.twitter.pushQue);VMM.Util.removeRange(VMM.master_config.twitter.que,0)}},getOEmbed:function(c,a){var d="//api.twitter.com/1/statuses/oembed.json?id="+c.mid+"&omit_script=true&include_entities=true&callback=?",b=setTimeout(VMM.ExternalAPI.twitter.errorTimeOutOembed,VMM.master_config.timers.api,c);VMM.getJSON(d,function(e){var g="",f="";g+=e.html.split("</p>&mdash;")[0]+"</p></blockquote>";f=e.author_url.split("twitter.com/")[1];g+="<div class='vcard author'>";g+="<a class='screen-name url' href='"+e.author_url+"' target='_blank'>";g+="<span class='avatar'></span>";g+="<span class='fn'>"+e.author_name+"</span>";g+="<span class='nickname'>@"+f+"<span class='thumbnail-inline'></span></span>";g+="</a>";g+="</div>";VMM.attachElement("#"+c.id.toString(),g);VMM.attachElement("#text_thumb_"+c.id.toString(),e.html);VMM.attachElement("#marker_content_"+c.id.toString(),e.html)}).error(function(f,g,e){trace("TWITTER error");trace("TWITTER ERROR: "+g+" "+f.responseText);clearTimeout(b);VMM.attachElement("#"+c.id,VMM.MediaElement.loadingmessage("ERROR LOADING TWEET "+c.mid))}).success(function(f){clearTimeout(b);a()})},getHTML:function(b){var a="//api.twitter.com/1/statuses/oembed.json?id="+b+"&omit_script=true&include_entities=true&callback=?";VMM.getJSON(a,VMM.ExternalAPI.twitter.onJSONLoaded)},onJSONLoaded:function(b){trace("TWITTER JSON LOADED");var a=b.id;VMM.attachElement("#"+a,VMM.Util.linkify_with_twitter(b.html))},parseTwitterDate:function(b){var a=new Date(Date.parse(b));return a},prettyParseTwitterDate:function(b){var a=new Date(Date.parse(b));return VMM.Date.prettyDate(a,!0)},getTweets:function(f){var b=[],g=f.length;for(var d=0;d<f.length;d++){var a="";f[d].tweet.match("status/")?a=f[d].tweet.split("status/")[1]:f[d].tweet.match("statuses/")?a=f[d].tweet.split("statuses/")[1]:a="";var c="//api.twitter.com/1/statuses/show.json?id="+a+"&include_entities=true&callback=?";VMM.getJSON(c,function(l){var k={},h="<div class='twitter'><blockquote><p>",j=VMM.Util.linkify_with_twitter(l.text,"_blank");h+=j;h+="</p>";h+="— "+l.user.name+" (<a href='https://twitter.com/"+l.user.screen_name+"'>@"+l.user.screen_name+"</a>) <a href='https://twitter.com/"+l.user.screen_name+"/status/"+l.id+"'>"+VMM.ExternalAPI.twitter.prettyParseTwitterDate(l.created_at)+" </a></blockquote></div>";k.content=h;k.raw=l;b.push(k);if(b.length==g){var m={tweetdata:b};VMM.fireEvent(global,"TWEETSLOADED",m)}}).success(function(){trace("second success")}).error(function(){trace("error")}).complete(function(){trace("complete")})}},getTweetSearch:function(d,b){var f=40;b!=null&&b!=""&&(f=b);var c="//search.twitter.com/search.json?q="+d+"&rpp="+f+"&include_entities=true&result_type=mixed",a=[];VMM.getJSON(c,function(k){for(var g=0;g<k.results.length;g++){var m={},j="<div class='twitter'><blockquote><p>",h=VMM.Util.linkify_with_twitter(k.results[g].text,"_blank");j+=h;j+="</p>";j+="— "+k.results[g].from_user_name+" (<a href='https://twitter.com/"+k.results[g].from_user+"'>@"+k.results[g].from_user+"</a>) <a href='https://twitter.com/"+k.results[g].from_user+"/status/"+k.id+"'>"+VMM.ExternalAPI.twitter.prettyParseTwitterDate(k.results[g].created_at)+" </a></blockquote></div>";m.content=j;m.raw=k.results[g];a.push(m)}var l={tweetdata:a};VMM.fireEvent(global,"TWEETSLOADED",l)})},prettyHTML:function(d,b){var d=d.toString(),f={twitterid:d},c="//api.twitter.com/1/statuses/show.json?id="+d+"&include_entities=true&callback=?",a=setTimeout(VMM.ExternalAPI.twitter.errorTimeOut,VMM.master_config.timers.api,d);VMM.getJSON(c,VMM.ExternalAPI.twitter.formatJSON).error(function(e,h,g){trace("TWITTER error");trace("TWITTER ERROR: "+h+" "+e.responseText);VMM.attachElement("#twitter_"+d,"<p>ERROR LOADING TWEET "+d+"</p>")}).success(function(g){clearTimeout(a);b&&VMM.ExternalAPI.twitter.secondaryMedia(g)})},formatJSON:function(c){var a=c.id_str,d="<blockquote><p>",b=VMM.Util.linkify_with_twitter(c.text,"_blank");d+=b;d+="</p></blockquote>";d+="<div class='vcard author'>";d+="<a class='screen-name url' href='https://twitter.com/"+c.user.screen_name+"' data-screen-name='"+c.user.screen_name+"' target='_blank'>";d+="<span class='avatar'><img src=' "+c.user.profile_image_url+"'  alt=''></span>";d+="<span class='fn'>"+c.user.name+"</span>";d+="<span class='nickname'>@"+c.user.screen_name+"<span class='thumbnail-inline'></span></span>";d+="</a>";d+="</div>";typeof c.entities.media!="undefined"&&c.entities.media[0].type=="photo"&&(d+="<img src=' "+c.entities.media[0].media_url+"'  alt=''>");VMM.attachElement("#twitter_"+a.toString(),d);VMM.attachElement("#text_thumb_"+a.toString(),c.text)}},googlemaps:{maptype:"TERRAIN",setMapType:function(a){a!=""&&(VMM.ExternalAPI.googlemaps.maptype=a)},get:function(c){var a,d,b;c.vars=VMM.Util.getUrlVars(c.id);VMM.ExternalAPI.keys.google!=""?d=VMM.ExternalAPI.keys.google:d=Aes.Ctr.decrypt(VMM.ExternalAPI.keys_master.google,VMM.ExternalAPI.keys_master.vp,256);b="//maps.googleapis.com/maps/api/js?key="+d+"&v=3.9&libraries=places&sensor=false&callback=VMM.ExternalAPI.googlemaps.onMapAPIReady";if(VMM.master_config.googlemaps.active){VMM.master_config.googlemaps.que.push(c)}else{VMM.master_config.googlemaps.que.push(c);VMM.master_config.googlemaps.api_loaded||LoadLib.js(b,function(){trace("Google Maps API Library Loaded")})}},create:function(a){VMM.ExternalAPI.googlemaps.createAPIMap(a)},createiFrameMap:function(c){var a=c.id+"&output=embed",d="",b=c.uid.toString()+"_gmap";d+="<div class='google-map' id='"+b+"' style='width=100%;height=100%;'>";d+="<iframe width='100%' height='100%' frameborder='0' scrolling='no' marginheight='0' marginwidth='0' src='"+a+"'></iframe>";d+="</div>";VMM.attachElement("#"+c.uid,d)},createAPIMap:function(M){function N(a){if(a in VMM.ExternalAPI.googlemaps.map_providers){A=VMM.ExternalAPI.googlemaps.map_attribution[VMM.ExternalAPI.googlemaps.map_providers[a].attribution];return VMM.ExternalAPI.googlemaps.map_providers[a]}if(VMM.ExternalAPI.googlemaps.defaultType(a)){trace("GOOGLE MAP DEFAULT TYPE");return google.maps.MapTypeId[a.toUpperCase()]}trace("Not a maptype: "+a)}function K(){var b=new google.maps.Geocoder,d=VMM.Util.getUrlVars(M.id).q,a;if(d.match("loc:")){var c=d.split(":")[1].split("+");z=new google.maps.LatLng(parseFloat(c[0]),parseFloat(c[1]));H=!0}b.geocode({address:d},function(g,f){if(f==google.maps.GeocoderStatus.OK){a=new google.maps.Marker({map:C,position:g[0].geometry.location});typeof g[0].geometry.viewport!="undefined"?C.fitBounds(g[0].geometry.viewport):typeof g[0].geometry.bounds!="undefined"?C.fitBounds(g[0].geometry.bounds):C.setCenter(g[0].geometry.location);H&&C.panTo(z);O&&C.setZoom(L)}else{trace("Geocode for "+d+" was not successful for the following reason: "+f);trace("TRYING PLACES SEARCH");H&&C.panTo(z);O&&C.setZoom(L);j()}})}function j(){function f(h,a){if(a==google.maps.places.PlacesServiceStatus.OK){for(var n=0;n<h.length;n++){}if(H){C.panTo(z)}else{if(h.length>=1){C.panTo(h[0].geometry.location);O&&C.setZoom(L)}}}else{trace("Place search for "+m.query+" was not successful for the following reason: "+a);trace("YOU MAY NEED A GOOGLE MAPS API KEY IN ORDER TO USE THIS FEATURE OF TIMELINEJS");trace("FIND OUT HOW TO GET YOUR KEY HERE: https://developers.google.com/places/documentation/#Authentication");if(H){C.panTo(z);O&&C.setZoom(L)}else{trace("USING SIMPLE IFRAME MAP EMBED");M.id[0].match("https")&&(M.id=M.url[0].replace("https","http"));VMM.ExternalAPI.googlemaps.createiFrameMap(M)}}}function g(h){var a,o;o=h.geometry.location;a=new google.maps.Marker({map:C,position:h.geometry.location});google.maps.event.addListener(a,"click",function(){c.setContent(h.name);c.open(C,this)})}var d,m,c,e,l,b;place_search=new google.maps.places.PlacesService(C);c=new google.maps.InfoWindow;m={query:"",types:["country","neighborhood","political","locality","geocode"]};type.of(VMM.Util.getUrlVars(M.id)["q"])=="string"&&(m.query=VMM.Util.getUrlVars(M.id).q);if(H){m.location=z;m.radius="15000"}else{l=new google.maps.LatLng(-89.999999,-179.999999);b=new google.maps.LatLng(89.999999,179.999999);e=new google.maps.LatLngBounds(l,b)}place_search.textSearch(m,f)}function P(){var b,c,a=!1;trace("LOADING PLACES API FOR GOOGLE MAPS");if(VMM.ExternalAPI.keys.google!=""){b=VMM.ExternalAPI.keys.google;a=!0}else{trace("YOU NEED A GOOGLE MAPS API KEY IN ORDER TO USE THIS FEATURE OF TIMELINEJS");trace("FIND OUT HOW TO GET YOUR KEY HERE: https://developers.google.com/places/documentation/#Authentication")}c="https://maps.googleapis.com/maps/api/place/textsearch/json?key="+b+"&sensor=false&language="+M.lang+"&";type.of(VMM.Util.getUrlVars(M.id)["q"])=="string"&&(c+="query="+VMM.Util.getUrlVars(M.id).q);H&&(c+="&location="+z);if(a){VMM.getJSON(c,function(e){trace("PLACES JSON");var h="",d="",f="",g="";trace(e);if(e.status=="OVER_QUERY_LIMIT"){trace("OVER_QUERY_LIMIT");if(H){C.panTo(z);O&&C.setZoom(L)}else{trace("DOING TRADITIONAL MAP IFRAME EMBED UNTIL QUERY LIMIT RESTORED");J=!0;VMM.ExternalAPI.googlemaps.createiFrameMap(M)}}else{if(e.results.length>=1){f=new google.maps.LatLng(parseFloat(e.results[0].geometry.viewport.northeast.lat),parseFloat(e.results[0].geometry.viewport.northeast.lng));g=new google.maps.LatLng(parseFloat(e.results[0].geometry.viewport.southwest.lat),parseFloat(e.results[0].geometry.viewport.southwest.lng));d=new google.maps.LatLngBounds(g,f);C.fitBounds(d)}else{trace("NO RESULTS")}H&&C.panTo(z);O&&C.setZoom(L)}}).error(function(f,d,g){trace("PLACES JSON ERROR");trace("PLACES JSON ERROR: "+d+" "+f.responseText)}).success(function(d){trace("PLACES JSON SUCCESS")})}else{if(H){C.panTo(z);O&&C.setZoom(L)}else{trace("DOING TRADITIONAL MAP IFRAME EMBED BECAUSE NO GOOGLE MAP API KEY WAS PROVIDED");VMM.ExternalAPI.googlemaps.createiFrameMap(M)}}}function k(){var b,d,a,c;b=M.id+"&output=kml";b=b.replace("&output=embed","");d=new google.maps.KmlLayer(b,{preserveViewport:!0});a=new google.maps.InfoWindow;d.setMap(C);google.maps.event.addListenerOnce(d,"defaultviewport_changed",function(){H?C.panTo(z):C.fitBounds(d.getDefaultViewport());O&&C.setZoom(L)});google.maps.event.addListener(d,"click",function(g){function f(h){a.setContent(h);a.open(C)}c=g.featureData.description;f(c)})}var A="",F,C,I,B=M.uid.toString()+"_gmap",E="",z=new google.maps.LatLng(41.875696,-87.624207),Q,L=11,H=!1,O=!1,J=!1,D;google.maps.VeriteMapType=function(b){if(VMM.ExternalAPI.googlemaps.defaultType(b)){return google.maps.MapTypeId[b.toUpperCase()]}var a=N(b);return google.maps.ImageMapType.call(this,{getTileUrl:function(f,g){var d=(g+f.x+f.y)%VMM.ExternalAPI.googlemaps.map_subdomains.length,c=a.url.replace("{S}",VMM.ExternalAPI.googlemaps.map_subdomains[d]).replace("{Z}",g).replace("{X}",f.x).replace("{Y}",f.y).replace("{z}",g).replace("{x}",f.x).replace("{y}",f.y);return c},tileSize:new google.maps.Size(256,256),name:b,minZoom:a.minZoom,maxZoom:a.maxZoom})};google.maps.VeriteMapType.prototype=new google.maps.ImageMapType("_");VMM.ExternalAPI.googlemaps.maptype!=""?VMM.ExternalAPI.googlemaps.defaultType(VMM.ExternalAPI.googlemaps.maptype)?F=google.maps.MapTypeId[VMM.ExternalAPI.googlemaps.maptype.toUpperCase()]:F=VMM.ExternalAPI.googlemaps.maptype:F=google.maps.MapTypeId.TERRAIN;var q=new RegExp(/@([0-9\.\-]+),([0-9\.\-]+),(\d+)z/);if(M.id.match(q)){var G=M.id.match(q);lat=parseFloat(G[1]);lng=parseFloat(G[2]);z=new google.maps.LatLng(lat,lng);L=parseFloat(G[3]);H=O=!0}else{if(type.of(VMM.Util.getUrlVars(M.id)["ll"])=="string"){H=!0;Q=VMM.Util.getUrlVars(M.id).ll.split(",");z=new google.maps.LatLng(parseFloat(Q[0]),parseFloat(Q[1]))}else{if(type.of(VMM.Util.getUrlVars(M.id)["sll"])=="string"){Q=VMM.Util.getUrlVars(M.id).sll.split(",");z=new google.maps.LatLng(parseFloat(Q[0]),parseFloat(Q[1]))}}if(type.of(VMM.Util.getUrlVars(M.id)["z"])=="string"){O=!0;L=parseFloat(VMM.Util.getUrlVars(M.id).z)}}I={zoom:L,draggable:!1,disableDefaultUI:!0,mapTypeControl:!1,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL,position:google.maps.ControlPosition.TOP_RIGHT},center:z,mapTypeId:F,mapTypeControlOptions:{mapTypeIds:[F]}};VMM.attachElement("#"+M.uid,"<div class='google-map' id='"+B+"' style='width=100%;height=100%;'></div>");C=new google.maps.Map(document.getElementById(B),I);if(!VMM.ExternalAPI.googlemaps.defaultType(VMM.ExternalAPI.googlemaps.maptype)){C.mapTypes.set(F,new google.maps.VeriteMapType(F));E="<div class='map-attribution'><div class='attribution-text'>"+A+"</div></div>";VMM.appendElement("#"+B,E)}type.of(VMM.Util.getUrlVars(M.id)["msid"])=="string"?k():type.of(VMM.Util.getUrlVars(M.id)["q"])=="string"&&K()},pushQue:function(){for(var a=0;a<VMM.master_config.googlemaps.que.length;a++){VMM.ExternalAPI.googlemaps.create(VMM.master_config.googlemaps.que[a])}VMM.master_config.googlemaps.que=[]},onMapAPIReady:function(){VMM.master_config.googlemaps.map_active=!0;VMM.master_config.googlemaps.places_active=!0;VMM.ExternalAPI.googlemaps.onAPIReady()},onPlacesAPIReady:function(){VMM.master_config.googlemaps.places_active=!0;VMM.ExternalAPI.googlemaps.onAPIReady()},onAPIReady:function(){if(!VMM.master_config.googlemaps.active&&VMM.master_config.googlemaps.map_active&&VMM.master_config.googlemaps.places_active){VMM.master_config.googlemaps.active=!0;VMM.ExternalAPI.googlemaps.pushQue()}},defaultType:function(a){return a.toLowerCase()=="satellite"||a.toLowerCase()=="hybrid"||a.toLowerCase()=="terrain"||a.toLowerCase()=="roadmap"?!0:!1},map_subdomains:["","a.","b.","c.","d."],map_attribution:{stamen:"Map tiles by <a href='http://stamen.com'>Stamen Design</a>, under <a href='http://creativecommons.org/licenses/by/3.0'>CC BY 3.0</a>. Data by <a href='http://openstreetmap.org'>OpenStreetMap</a>, under <a href='http://creativecommons.org/licenses/by-sa/3.0'>CC BY SA</a>.",apple:"Map data &copy; 2012  Apple, Imagery &copy; 2012 Apple",osm:"&copy; <a href='http://www.openstreetmap.org/copyright'>OpenStreetMap</a> contributors"},map_providers:{toner:{url:"//{S}tile.stamen.com/toner/{Z}/{X}/{Y}.png",minZoom:0,maxZoom:20,attribution:"stamen"},"toner-lines":{url:"//{S}tile.stamen.com/toner-lines/{Z}/{X}/{Y}.png",minZoom:0,maxZoom:20,attribution:"stamen"},"toner-labels":{url:"//{S}tile.stamen.com/toner-labels/{Z}/{X}/{Y}.png",minZoom:0,maxZoom:20,attribution:"stamen"},sterrain:{url:"//{S}tile.stamen.com/terrain/{Z}/{X}/{Y}.jpg",minZoom:4,maxZoom:20,attribution:"stamen"},apple:{url:"//gsp2.apple.com/tile?api=1&style=slideshow&layers=default&lang=en_US&z={z}&x={x}&y={y}&v=9",minZoom:4,maxZoom:14,attribution:"apple"},watercolor:{url:"//{S}tile.stamen.com/watercolor/{Z}/{X}/{Y}.jpg",minZoom:3,maxZoom:16,attribution:"stamen"},osm:{url:"//tile.openstreetmap.org/{z}/{x}/{y}.png",minZoom:3,maxZoom:18,attribution:"osm"}}},googleplus:{get:function(b){var a,c={user:b.user,activity:b.id,id:b.uid};VMM.master_config.googleplus.que.push(c);VMM.master_config.googleplus.active=!0},create:function(g,k){var d="",b="",f="",l="",c="",j,h;googleplus_timeout=setTimeout(VMM.ExternalAPI.googleplus.errorTimeOut,VMM.master_config.timers.api,g),callback_timeout=setTimeout(k,VMM.master_config.timers.api,g);VMM.master_config.Timeline.api_keys.google!=""?b=VMM.master_config.Timeline.api_keys.google:b=Aes.Ctr.decrypt(VMM.master_config.api_keys_master.google,VMM.master_config.vp,256);j="https://www.googleapis.com/plus/v1/people/"+g.user+"/activities/public?alt=json&maxResults=100&fields=items(id,url)&key="+b;d="GOOGLE PLUS API CALL";VMM.getJSON(j,function(e){for(var a=0;a<e.items.length;a++){trace("loop");if(e.items[a].url.split("posts/")[1]==g.activity){trace("FOUND IT!!");f=e.items[a].id;h="https://www.googleapis.com/plus/v1/activities/"+f+"?alt=json&key="+b;VMM.getJSON(h,function(m){trace(m);if(typeof m.annotation!="undefined"){l+="<div class='googleplus-annotation'>'"+m.annotation+"</div>";l+=m.object.content}else{l+=m.object.content}if(typeof m.object.attachments!="undefined"){for(var n=0;n<m.object.attachments.length;n++){if(m.object.attachments[n].objectType=="photo"){c="<a href='"+m.object.url+"' target='_blank'><img src='"+m.object.attachments[n].image.url+"' class='article-thumb'></a>"+c}else{if(m.object.attachments[n].objectType=="video"){c="<img src='"+m.object.attachments[n].image.url+"' class='article-thumb'>"+c;c+="<div>";c+="<a href='"+m.object.attachments[n].url+"' target='_blank'>";c+="<h5>"+m.object.attachments[n].displayName+"</h5>";c+="</a>";c+="</div>"}else{if(m.object.attachments[n].objectType=="article"){c+="<div>";c+="<a href='"+m.object.attachments[n].url+"' target='_blank'>";c+="<h5>"+m.object.attachments[n].displayName+"</h5>";c+="<p>"+m.object.attachments[n].content+"</p>";c+="</a>";c+="</div>"}}}trace(m.object.attachments[n])}c="<div class='googleplus-attachments'>"+c+"</div>"}d="<div class='googleplus-content'>"+l+c+"</div>";d+="<div class='vcard author'><a class='screen-name url' href='"+m.url+"' target='_blank'>";d+="<span class='avatar'><img src='"+m.actor.image.url+"' style='max-width: 32px; max-height: 32px;'></span>";d+="<span class='fn'>"+m.actor.displayName+"</span>";d+="<span class='nickname'><span class='thumbnail-inline'></span></span>";d+="</a></div>";VMM.attachElement("#googleplus_"+g.activity,d)});break}}}).error(function(e,o,m){var a=VMM.parseJSON(e.responseText);trace(a.error.message);VMM.attachElement("#googleplus_"+g.activity,VMM.MediaElement.loadingmessage("<p>ERROR LOADING GOOGLE+ </p><p>"+a.error.message+"</p>"))}).success(function(a){clearTimeout(googleplus_timeout);clearTimeout(callback_timeout);k()})},pushQue:function(){if(VMM.master_config.googleplus.que.length>0){VMM.ExternalAPI.googleplus.create(VMM.master_config.googleplus.que[0],VMM.ExternalAPI.googleplus.pushQue);VMM.Util.removeRange(VMM.master_config.googleplus.que,0)}},errorTimeOut:function(a){trace("GOOGLE+ JSON ERROR TIMEOUT "+a.activity);VMM.attachElement("#googleplus_"+a.activity,VMM.MediaElement.loadingmessage("<p>Still waiting on GOOGLE+ </p><p>"+a.activity+"</p>"))}},googledocs:{get:function(a){VMM.master_config.googledocs.que.push(a);VMM.master_config.googledocs.active=!0},create:function(b){var a="";b.id.match(/docs.google.com/i)?a="<iframe class='doc' frameborder='0' width='100%' height='100%' src='"+b.id+"&amp;embedded=true'></iframe>":a="<iframe class='doc' frameborder='0' width='100%' height='100%' src='//docs.google.com/viewer?url="+b.id+"&amp;embedded=true'></iframe>";VMM.attachElement("#"+b.uid,a)},pushQue:function(){for(var a=0;a<VMM.master_config.googledocs.que.length;a++){VMM.ExternalAPI.googledocs.create(VMM.master_config.googledocs.que[a])}VMM.master_config.googledocs.que=[]}},flickr:{get:function(a){VMM.master_config.flickr.que.push(a);VMM.master_config.flickr.active=!0},create:function(d,b){var f,c=setTimeout(b,VMM.master_config.timers.api,d);typeof VMM.master_config.Timeline!="undefined"&&VMM.master_config.Timeline.api_keys.flickr!=""?f=VMM.master_config.Timeline.api_keys.flickr:f=Aes.Ctr.decrypt(VMM.master_config.api_keys_master.flickr,VMM.master_config.vp,256);var a="https://api.flickr.com/services/rest/?method=flickr.photos.getSizes&api_key="+f+"&photo_id="+d.id+"&format=json&jsoncallback=?";VMM.getJSON(a,function(p){var h=VMM.ExternalAPI.flickr.getFlickrIdFromUrl(p.sizes.size[0].url),e="#"+d.uid,j="#"+d.uid+"_thumb",q,g,m=!1,l="Large";l=VMM.ExternalAPI.flickr.sizes(VMM.master_config.sizes.api.height);for(var k=0;k<p.sizes.size.length;k++){if(p.sizes.size[k].label==l){m=!0;q=p.sizes.size[k].source}}m||(q=p.sizes.size[p.sizes.size.length-2].source);g=p.sizes.size[0].source;VMM.Lib.attr(e,"src",q);VMM.attachElement(j,"<img src='"+g+"'>")}).error(function(h,g,j){trace("FLICKR error");trace("FLICKR ERROR: "+g+" "+h.responseText)}).success(function(g){clearTimeout(c);b()})},pushQue:function(){if(VMM.master_config.flickr.que.length>0){VMM.ExternalAPI.flickr.create(VMM.master_config.flickr.que[0],VMM.ExternalAPI.flickr.pushQue);VMM.Util.removeRange(VMM.master_config.flickr.que,0)}},sizes:function(b){var a="";b<=75?a="Thumbnail":b<=180?a="Small":b<=240?a="Small 320":b<=375?a="Medium":b<=480?a="Medium 640":b<=600?a="Large":a="Large";return a},getFlickrIdFromUrl:function(c){var a=c.indexOf("flickr.com/photos/");if(a==-1){return null}var d=a+"flickr.com/photos/".length,b=c.substr(d);if(b.indexOf("/")==-1){return null}b.indexOf("/")==0&&(b=b.substr(1));return b.split("/")[1]}},instagram:{get:function(b,a){return a?"//instagr.am/p/"+b.id+"/media/?size=t":"//instagr.am/p/"+b.id+"/media/?size="+VMM.ExternalAPI.instagram.sizes(VMM.master_config.sizes.api.height)},sizes:function(b){var a="";b<=150?a="t":b<=306?a="m":a="l";return a},isInstagramUrl:function(a){return a.match("instagr.am/p/")||a.match("instagram.com/p/")},getInstagramIdFromUrl:function(b){try{return b.split("/p/")[1].split("/")[0]}catch(a){trace("Invalid Instagram url: "+b);return null}}},soundcloud:{get:function(a){VMM.master_config.soundcloud.que.push(a);VMM.master_config.soundcloud.active=!0},create:function(b,a){var c="//soundcloud.com/oembed?url="+b.id+"&maxheight=168&format=js&callback=?";VMM.getJSON(c,function(d){VMM.attachElement("#"+b.uid,d.html);a()})},pushQue:function(){if(VMM.master_config.soundcloud.que.length>0){VMM.ExternalAPI.soundcloud.create(VMM.master_config.soundcloud.que[0],VMM.ExternalAPI.soundcloud.pushQue);VMM.Util.removeRange(VMM.master_config.soundcloud.que,0)}}},wikipedia:{get:function(a){VMM.master_config.wikipedia.que.push(a);VMM.master_config.wikipedia.active=!0},create:function(c,a){var d="//"+c.lang+".wikipedia.org/w/api.php?action=query&prop=extracts&redirects=&titles="+c.id+"&exintro=1&format=json&callback=?";callback_timeout=setTimeout(a,VMM.master_config.timers.api,c);if(VMM.Browser.browser=="Explorer"&&parseInt(VMM.Browser.version,10)>=7&&window.XDomainRequest){var b="<h4><a href='http://"+VMM.master_config.language.api.wikipedia+".wikipedia.org/wiki/"+c.id+"' target='_blank'>"+c.url+"</a></h4>";b+="<span class='wiki-source'>"+VMM.master_config.language.messages.wikipedia+"</span>";b+="<p>Wikipedia entry unable to load using Internet Explorer 8 or below.</p>";VMM.attachElement("#"+c.uid,b)}VMM.getJSON(d,function(h){if(h.query){var m,k,g="",j="",l=1,f=[];m=VMM.Util.getObjectAttributeByIndex(h.query.pages,0).extract;k=VMM.Util.getObjectAttributeByIndex(h.query.pages,0).title;m.match("<p>")?f=m.split("<p>"):f.push(m);for(var e=0;e<f.length;e++){e+1<=l&&e+1<f.length&&(j+="<p>"+f[e+1])}g="<h4><a href='http://"+VMM.master_config.language.api.wikipedia+".wikipedia.org/wiki/"+k+"' target='_blank'>"+k+"</a></h4>";g+="<span class='wiki-source'>"+VMM.master_config.language.messages.wikipedia+"</span>";g+=VMM.Util.linkify_wikipedia(j);m.match("REDIRECT")||VMM.attachElement("#"+c.uid,g)}}).error(function(g,f,e){trace("WIKIPEDIA error");trace("WIKIPEDIA ERROR: "+f+" "+g.responseText);trace(e);VMM.attachElement("#"+c.uid,VMM.MediaElement.loadingmessage("<p>Wikipedia is not responding</p>"));clearTimeout(callback_timeout);if(VMM.master_config.wikipedia.tries<4){trace("WIKIPEDIA ATTEMPT "+VMM.master_config.wikipedia.tries);trace(c);VMM.master_config.wikipedia.tries++;VMM.ExternalAPI.wikipedia.create(c,a)}else{a()}}).success(function(f){VMM.master_config.wikipedia.tries=0;clearTimeout(callback_timeout);a()})},pushQue:function(){if(VMM.master_config.wikipedia.que.length>0){trace("WIKIPEDIA PUSH QUE "+VMM.master_config.wikipedia.que.length);VMM.ExternalAPI.wikipedia.create(VMM.master_config.wikipedia.que[0],VMM.ExternalAPI.wikipedia.pushQue);VMM.Util.removeRange(VMM.master_config.wikipedia.que,0)}}},youtube:{get:function(b){var a="//gdata.youtube.com/feeds/api/videos/"+b.id+"?v=2&alt=jsonc&callback=?";VMM.master_config.youtube.que.push(b);VMM.master_config.youtube.active||VMM.master_config.youtube.api_loaded||LoadLib.js("//www.youtube.com/player_api",function(){trace("YouTube API Library Loaded")});VMM.getJSON(a,function(c){VMM.ExternalAPI.youtube.createThumb(c,b)})},create:function(d){if(typeof d.start!="undefined"){var b=d.start.toString(),f=0,c=0;if(b.match("m")){f=parseInt(b.split("m")[0],10);c=parseInt(b.split("m")[1].split("s")[0],10);d.start=f*60+c}else{d.start=0}}else{d.start=0}var a={active:!1,player:{},name:d.uid,playing:!1,hd:!1};typeof d.hd!="undefined"&&(a.hd=!0);a.player[d.id]=new YT.Player(d.uid,{height:"390",width:"640",playerVars:{enablejsapi:1,color:"white",showinfo:0,theme:"light",start:d.start,rel:0},videoId:d.id,events:{onReady:VMM.ExternalAPI.youtube.onPlayerReady,onStateChange:VMM.ExternalAPI.youtube.onStateChange}});VMM.master_config.youtube.array.push(a)},createThumb:function(b,a){trace("CREATE THUMB");trace(b);trace(a);if(typeof b.data!="undefined"){var c="#"+a.uid+"_thumb";VMM.attachElement(c,"<img src='"+b.data.thumbnail.sqDefault+"'>")}},pushQue:function(){for(var a=0;a<VMM.master_config.youtube.que.length;a++){VMM.ExternalAPI.youtube.create(VMM.master_config.youtube.que[a])}VMM.master_config.youtube.que=[]},onAPIReady:function(){VMM.master_config.youtube.active=!0;VMM.ExternalAPI.youtube.pushQue()},stopPlayers:function(){for(var a=0;a<VMM.master_config.youtube.array.length;a++){VMM.master_config.youtube.array[a].playing&&typeof VMM.master_config.youtube.array[a].player.the_name!="undefined"&&VMM.master_config.youtube.array[a].player.the_name.stopVideo()}},onStateChange:function(b){for(var a=0;a<VMM.master_config.youtube.array.length;a++){for(var c in VMM.master_config.youtube.array[a].player){VMM.master_config.youtube.array[a].player[c]==b.target&&(VMM.master_config.youtube.array[a].player.the_name=VMM.master_config.youtube.array[a].player[c])}if(VMM.master_config.youtube.array[a].player.the_name==b.target&&b.data==YT.PlayerState.PLAYING){VMM.master_config.youtube.array[a].playing=!0;if(VMM.master_config.youtube.array[a].hd===!1){VMM.master_config.youtube.array[a].hd=!0;VMM.master_config.youtube.array[a].player.the_name.setPlaybackQuality("hd720")}}}},onPlayerReady:function(a){}},vimeo:{get:function(a){VMM.master_config.vimeo.que.push(a);VMM.master_config.vimeo.active=!0},create:function(c,a){trace("VIMEO CREATE");var d="//vimeo.com/api/v2/video/"+c.id+".json",b="//player.vimeo.com/video/"+c.id+"?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff";VMM.getJSON(d,function(e){VMM.ExternalAPI.vimeo.createThumb(e,c);a()});VMM.attachElement("#"+c.uid,"<iframe autostart='false' frameborder='0' width='100%' height='100%' src='"+b+"'></iframe>")},createThumb:function(b,a){trace("VIMEO CREATE THUMB");var c="#"+a.uid+"_thumb";VMM.attachElement(c,"<img src='"+b[0].thumbnail_small+"'>")},pushQue:function(){if(VMM.master_config.vimeo.que.length>0){VMM.ExternalAPI.vimeo.create(VMM.master_config.vimeo.que[0],VMM.ExternalAPI.vimeo.pushQue);VMM.Util.removeRange(VMM.master_config.vimeo.que,0)}}},vine:{get:function(a){VMM.master_config.vine.que.push(a);VMM.master_config.vine.active=!0},create:function(b,a){trace("VINE CREATE");var c="https://vine.co/v/"+b.id+"/embed/simple";VMM.attachElement("#"+b.uid,"<iframe frameborder='0' width='100%' height='100%' src='"+c+"'></iframe><script async src='http://platform.vine.co/static/scripts/embed.js' charset='utf-8'><\/script>")},pushQue:function(){if(VMM.master_config.vine.que.length>0){VMM.ExternalAPI.vine.create(VMM.master_config.vine.que[0],VMM.ExternalAPI.vine.pushQue);VMM.Util.removeRange(VMM.master_config.vine.que,0)}}},webthumb:{get:function(b,a){VMM.master_config.webthumb.que.push(b);VMM.master_config.webthumb.active=!0},sizes:function(b){var a="";b<=150?a="t":b<=306?a="m":a="l";return a},create:function(b){trace("WEB THUMB CREATE");var a="//api.pagepeeker.com/v2/thumbs.php?";url=b.id.replace("http://","");VMM.attachElement("#"+b.uid,"<a href='"+b.id+"' target='_blank'><img src='"+a+"size=x&url="+url+"'></a>");VMM.attachElement("#"+b.uid+"_thumb","<img src='"+a+"size=t&url="+url+"'>")},pushQue:function(){for(var a=0;a<VMM.master_config.webthumb.que.length;a++){VMM.ExternalAPI.webthumb.create(VMM.master_config.webthumb.que[a])}VMM.master_config.webthumb.que=[]}}}.init());typeof VMM!="undefined"&&typeof VMM.MediaElement=="undefined"&&(VMM.MediaElement={init:function(){return this},loadingmessage:function(a){return"<div class='vco-loading'><div class='vco-loading-container'><div class='vco-loading-icon'></div><div class='vco-message'><p>"+a+"</p></div></div></div>"},thumbnail:function(j,m,d,b){var g=16,p=24,c="";m!=null&&m!=""&&(g=m);d!=null&&d!=""&&(p=d);b!=null&&b!=""&&(c=b);if(j.thumbnail!=null&&j.thumbnail!=""){trace("CUSTOM THUMB");k="<div class='thumbnail thumb-custom' id='"+b+"_custom_thumb'><img src='"+j.thumbnail+"'></div>";return k}if(j.media!=null&&j.media!=""){var l=!0,k="",h=VMM.MediaType(j.media);if(h.type=="image"){k="<div class='thumbnail thumb-photo'></div>";return k}if(h.type=="flickr"){k="<div class='thumbnail thumb-photo' id='"+b+"_thumb'></div>";return k}if(h.type=="instagram"){k="<div class='thumbnail thumb-instagram' id='"+b+"_thumb'><img src='"+VMM.ExternalAPI.instagram.get(h,!0)+"'></div>";return k}if(h.type=="youtube"){k="<div class='thumbnail thumb-youtube' id='"+b+"_thumb'></div>";return k}if(h.type=="googledoc"){k="<div class='thumbnail thumb-document'></div>";return k}if(h.type=="vimeo"){k="<div class='thumbnail thumb-vimeo' id='"+b+"_thumb'></div>";return k}if(h.type=="vine"){k="<div class='thumbnail thumb-vine'></div>";return k}if(h.type=="dailymotion"){k="<div class='thumbnail thumb-video'></div>";return k}if(h.type=="twitter"){k="<div class='thumbnail thumb-twitter'></div>";return k}if(h.type=="twitter-ready"){k="<div class='thumbnail thumb-twitter'></div>";return k}if(h.type=="soundcloud"){k="<div class='thumbnail thumb-audio'></div>";return k}if(h.type=="google-map"){k="<div class='thumbnail thumb-map'></div>";return k}if(h.type=="googleplus"){k="<div class='thumbnail thumb-googleplus'></div>";return k}if(h.type=="wikipedia"){k="<div class='thumbnail thumb-wikipedia'></div>";return k}if(h.type=="storify"){k="<div class='thumbnail thumb-storify'></div>";return k}if(h.type=="quote"){k="<div class='thumbnail thumb-quote'></div>";return k}if(h.type=="iframe"){k="<div class='thumbnail thumb-video'></div>";return k}if(h.type=="unknown"){h.id.match("blockquote")?k="<div class='thumbnail thumb-quote'></div>":k="<div class='thumbnail thumb-plaintext'></div>";return k}if(h.type=="website"){k="<div class='thumbnail thumb-website' id='"+b+"_thumb'></div>";return k}k="<div class='thumbnail thumb-plaintext'></div>";return k}},create:function(j,m){var d=!1,b=VMM.MediaElement.loadingmessage(VMM.master_config.language.messages.loading+"...");if(j.media!=null&&j.media!=""){var g="",p="",c="",l="",k=!1,h;h=VMM.MediaType(j.media);h.uid=m;d=!0;j.credit!=null&&j.credit!=""&&(c="<div class='credit'>"+VMM.Util.linkify_with_twitter(j.credit,"_blank")+"</div>");j.caption!=null&&j.caption!=""&&(p="<div class='caption'>"+VMM.Util.linkify_with_twitter(j.caption,"_blank")+"</div>");if(h.type=="image"){h.id.match("https://")&&(h.id=h.id.replace("https://","http://"));g="<div class='media-image media-shadow'><img src='"+h.id+"' class='media-image'></div>"}else{if(h.type=="flickr"){g="<div class='media-image media-shadow'><a href='"+h.link+"' target='_blank'><img id='"+m+"'></a></div>";VMM.ExternalAPI.flickr.get(h)}else{if(h.type=="instagram"){g="<div class='media-image media-shadow'><a href='"+h.link+"' target='_blank'><img src='"+VMM.ExternalAPI.instagram.get(h)+"'></a></div>"}else{if(h.type=="googledoc"){g="<div class='media-frame media-shadow doc' id='"+h.uid+"'>"+b+"</div>";VMM.ExternalAPI.googledocs.get(h)}else{if(h.type=="youtube"){g="<div class='media-shadow'><div class='media-frame video youtube' id='"+h.uid+"'>"+b+"</div></div>";VMM.ExternalAPI.youtube.get(h)}else{if(h.type=="vimeo"){g="<div class='media-shadow media-frame video vimeo' id='"+h.uid+"'>"+b+"</div>";VMM.ExternalAPI.vimeo.get(h)}else{if(h.type=="dailymotion"){g="<div class='media-shadow'><iframe class='media-frame video dailymotion' autostart='false' frameborder='0' width='100%' height='100%' src='http://www.dailymotion.com/embed/video/"+h.id+"'></iframe></div>"}else{if(h.type=="vine"){g="<div class='media-shadow media-frame video vine' id='"+h.uid+"'>"+b+"</div>";VMM.ExternalAPI.vine.get(h)}else{if(h.type=="twitter"){g="<div class='twitter' id='"+h.uid+"'>"+b+"</div>";k=!0;VMM.ExternalAPI.twitter.get(h)}else{if(h.type=="twitter-ready"){k=!0;g=h.id}else{if(h.type=="soundcloud"){g="<div class='media-frame media-shadow soundcloud' id='"+h.uid+"'>"+b+"</div>";VMM.ExternalAPI.soundcloud.get(h)}else{if(h.type=="google-map"){g="<div class='media-frame media-shadow map' id='"+h.uid+"'>"+b+"</div>";VMM.ExternalAPI.googlemaps.get(h)}else{if(h.type=="googleplus"){l="googleplus_"+h.id;g="<div class='googleplus' id='"+l+"'>"+b+"</div>";k=!0;VMM.ExternalAPI.googleplus.get(h)}else{if(h.type=="wikipedia"){g="<div class='wikipedia' id='"+h.uid+"'>"+b+"</div>";k=!0;VMM.ExternalAPI.wikipedia.get(h)}else{if(h.type=="storify"){k=!0;g="<div class='plain-text-quote'>"+h.id+"</div>"}else{if(h.type=="iframe"){k=!0;g="<div class='media-shadow'><iframe class='media-frame video' autostart='false' frameborder='0' width='100%' height='100%' src='"+h.id+"'></iframe></div>"}else{if(h.type=="quote"){k=!0;g="<div class='plain-text-quote'>"+h.id+"</div>"}else{if(h.type=="unknown"){trace("NO KNOWN MEDIA TYPE FOUND TRYING TO JUST PLACE THE HTML");k=!0;g="<div class='plain-text'><div class='container'>"+VMM.Util.properQuotes(h.id)+"</div></div>"}else{if(h.type=="website"){g="<div class='media-shadow website' id='"+h.uid+"'>"+b+"</div>";VMM.ExternalAPI.webthumb.get(h)}else{trace("NO KNOWN MEDIA TYPE FOUND");trace(h.type)}}}}}}}}}}}}}}}}}}}g="<div class='media-container' >"+g+c+p+"</div>";return k?"<div class='text-media'><div class='media-wrapper'>"+g+"</div></div>":"<div class='media-wrapper'>"+g+"</div>"}}}.init());typeof VMM!="undefined"&&typeof VMM.MediaType=="undefined"&&(VMM.MediaType=function(d){var b=d.replace(/^\s\s*/,"").replace(/\s\s*$/,""),f=!1,c={type:"unknown",id:"",start:0,hd:!1,link:"",lang:VMM.Language.lang,uniqueid:VMM.Util.unique_ID(6)};if(b.match("div class='twitter'")){c.type="twitter-ready";c.id=b;f=!0}else{if(b.match("<blockquote")){c.type="quote";c.id=b;f=!0}else{if(b.match("<iframe")){c.type="iframe";trace("IFRAME");regex=/src=['"](\S+?)['"]/;group=b.match(regex);group&&(c.id=group[1]);trace("iframe url: "+c.id);f=Boolean(c.id)}else{if(b.match("(www.)?youtube|youtu.be")){b.match("v=")?c.id=VMM.Util.getUrlVars(b).v:b.match("/embed/")?c.id=b.split("embed/")[1].split(/[?&]/)[0]:b.match(/v\/|v=|youtu\.be\//)?c.id=b.split(/v\/|v=|youtu\.be\//)[1].split(/[?&]/)[0]:trace("YOUTUBE IN URL BUT NOT A VALID VIDEO");c.start=VMM.Util.getUrlVars(b).t;c.hd=VMM.Util.getUrlVars(b).hd;c.type="youtube";f=!0}else{if(b.match("(player.)?vimeo.com")){c.type="vimeo";c.id=b.split(/video\/|\/\/vimeo\.com\//)[1].split(/[?&]/)[0];f=!0}else{if(b.match("(www.)?dailymotion.com")){c.id=b.split(/video\/|\/\/dailymotion\.com\//)[1];c.type="dailymotion";f=!0}else{if(b.match("(www.)?vine.co")){trace("VINE");if(b.match("vine.co/v/")){c.id=b.split("vine.co/v/")[1];trace(c.id)}trace(b);c.type="vine";f=!0}else{if(b.match("(player.)?soundcloud.com")){c.type="soundcloud";c.id=b;f=!0}else{if(b.match("(www.)?twitter.com")&&b.match("status")){b.match("status/")?c.id=b.split("status/")[1]:b.match("statuses/")?c.id=b.split("statuses/")[1]:c.id="";c.type="twitter";f=!0}else{if(b.match("maps.google")&&!b.match("staticmap")&&!b.match("streetview")){c.type="google-map";c.id=b;f=!0}else{if(b.match(/www.google.\w+\/maps/)){c.type="google-map";c.id=b;f=!0}else{if(b.match("plus.google")){c.type="googleplus";c.id=b.split("/posts/")[1];b.split("/posts/")[0].match("u/0/")?c.user=b.split("u/0/")[1].split("/posts")[0]:c.user=b.split("google.com/")[1].split("/posts/")[0];f=!0}else{if(b.match("flickr.com/photos/")){c.type="flickr";c.id=VMM.ExternalAPI.flickr.getFlickrIdFromUrl(b);c.link=b;f=Boolean(c.id)}else{if(VMM.ExternalAPI.instagram.isInstagramUrl(b)){c.type="instagram";c.link=b;c.id=VMM.ExternalAPI.instagram.getInstagramIdFromUrl(b);f=Boolean(c.id)}else{if(b.match(/jpg|jpeg|png|gif|svg|bmp/i)||b.match("staticmap")||b.match("yfrog.com")||b.match("twitpic.com")||b.match("maps.googleapis.com/maps/api/streetview")){c.type="image";c.id=b;f=!0}else{if(VMM.FileExtention.googleDocType(b)){c.type="googledoc";c.id=b;f=!0}else{if(b.match("(www.)?wikipedia.org")){c.type="wikipedia";var a=b.split("wiki/")[1].split("#")[0].replace("_"," ");c.id=a.replace(" ","%20");c.lang=b.split("//")[1].split(".wikipedia")[0];f=!0}else{if(b.indexOf("http://")==0){c.type="website";c.id=b;f=!0}else{if(b.match("storify")){c.type="storify";c.id=b;f=!0}else{trace("unknown media");c.type="unknown";c.id=b;f=!0}}}}}}}}}}}}}}}}}}}if(f){return c}trace("No valid media id detected");trace(b);return !1});typeof VMM!="undefined"&&typeof VMM.TextElement=="undefined"&&(VMM.TextElement={init:function(){return this},create:function(a){return a}}.init());typeof VMM!="undefined"&&typeof VMM.DragSlider=="undefined"&&(VMM.DragSlider=function(){function j(a,c){VMM.bindEvent(a,C,F.down,{element:c,delement:a});VMM.bindEvent(a,y,F.up,{element:c,delement:a});VMM.bindEvent(a,E,F.leave,{element:c,delement:a})}function E(a){VMM.unbindEvent(a.data.delement,m,F.move);z.touch||a.preventDefault();a.stopPropagation();if(z.sliding){z.sliding=!1;w(a.data.element,a.data.delement,a);return !1}return !0}function C(a){B(a.data.element,a.data.delement,a);z.touch||a.preventDefault();return !0}function y(a){z.touch||a.preventDefault();if(z.sliding){z.sliding=!1;w(a.data.element,a.data.delement,a);return !1}return !0}function m(a){g(a.data.element,a)}function B(d,c,a){if(z.touch){trace("IS TOUCH");VMM.Lib.css(d,"-webkit-transition-duration","0");z.pagex.start=a.originalEvent.touches[0].screenX;z.pagey.start=a.originalEvent.touches[0].screenY}else{z.pagex.start=a.pageX;z.pagey.start=a.pageY}z.left.start=D(d);z.time.start=(new Date).getTime();VMM.Lib.stop(d);VMM.bindEvent(c,m,F.move,{element:d})}function w(c,d,a){VMM.unbindEvent(d,m,F.move);A(c,a)}function g(c,e){var d,a;z.sliding=!0;if(z.touch){z.pagex.end=e.originalEvent.touches[0].screenX;z.pagey.end=e.originalEvent.touches[0].screenY}else{z.pagex.end=e.pageX;z.pagey.end=e.pageY}z.left.end=D(c);d=-(z.pagex.start-z.pagex.end-z.left.start);if(Math.abs(z.pagey.start)-Math.abs(z.pagey.end)>10){trace("SCROLLING Y");trace(Math.abs(z.pagey.start)-Math.abs(z.pagey.end))}if(Math.abs(d-z.left.start)>10){VMM.Lib.css(c,"left",d);e.preventDefault();e.stopPropagation()}}function A(a,e){var c={left:z.left.end,left_adjust:0,change:{x:0},time:((new Date).getTime()-z.time.start)*10,time_adjust:((new Date).getTime()-z.time.start)*10},d=3000;z.touch&&(d=6000);c.change.x=d*(Math.abs(z.pagex.end)-Math.abs(z.pagex.start));c.left_adjust=Math.round(c.change.x/c.time);c.left=Math.min(c.left+c.left_adjust);if(z.constraint){if(c.left>z.constraint.left){c.left=z.constraint.left;c.time>5000&&(c.time=5000)}else{if(c.left<z.constraint.right){c.left=z.constraint.right;c.time>5000&&(c.time=5000)}}}VMM.fireEvent(q,"DRAGUPDATE",[c]);G||c.time>0&&(z.touch?VMM.Lib.animate(a,c.time,"easeOutCirc",{left:c.left}):VMM.Lib.animate(a,c.time,z.ease,{left:c.left}))}function D(a){return parseInt(VMM.Lib.css(a,"left").substring(0,VMM.Lib.css(a,"left").length-2),10)}var z={element:"",element_move:"",constraint:"",sliding:!1,pagex:{start:0,end:0},pagey:{start:0,end:0},left:{start:0,end:0},time:{start:0,end:0},touch:!1,ease:"easeOutExpo"},F={down:"mousedown",up:"mouseup",leave:"mouseleave",move:"mousemove"},k={down:"mousedown",up:"mouseup",leave:"mouseleave",move:"mousemove"},b={down:"touchstart",up:"touchend",leave:"mouseleave",move:"touchmove"},q=this,G=!1;this.createPanel=function(h,e,d,n,c){z.element=h;z.element_move=e;c!=null&&c!=""&&(G=c);d!=null&&d!=""?z.constraint=d:z.constraint=!1;n?z.touch=n:z.touch=!1;trace("TOUCH"+z.touch);z.touch?F=b:F=k;j(z.element,z.element_move)};this.updateConstraint=function(a){trace("updateConstraint");z.constraint=a};this.cancelSlide=function(a){VMM.unbindEvent(z.element,m,F.move);return !0}});typeof VMM!="undefined"&&typeof VMM.Slider=="undefined"&&(VMM.Slider=function(aI,at){function V(){trace("onConfigSet")}function ao(d,b){var c=!0,a=!1;d!=null&&(c=d);b!=null&&(a=b);aA=az.slider.width;az.slider.nav.height=VMM.Lib.height(ah.prevBtnContainer);VMM.Browser.device=="mobile"||aA<=640?az.slider.content.padding=10:az.slider.content.padding=az.slider.content.padding_default;az.slider.content.width=aA-az.slider.content.padding*2;VMM.Lib.width(ar,aF.length*az.slider.content.width);a&&VMM.Lib.css(ay,"left",aF[aq].leftpos());ak();aD();VMM.Lib.css(ah.nextBtn,"left",aA-az.slider.nav.width);VMM.Lib.height(ah.prevBtn,az.slider.height);VMM.Lib.height(ah.nextBtn,az.slider.height);VMM.Lib.css(ah.nextBtnContainer,"top",az.slider.height/2-az.slider.nav.height/2+10);VMM.Lib.css(ah.prevBtnContainer,"top",az.slider.height/2-az.slider.nav.height/2+10);VMM.Lib.height(au,az.slider.height);VMM.Lib.width(au,aA);c&&ae(aq,"linear",1);aq==0&&VMM.Lib.visible(ah.prevBtn,!1)}function Q(b,a){trace("DRAG FINISH");trace(a.left_adjust);trace(az.slider.width/2);if(a.left_adjust<0){if(Math.abs(a.left_adjust)>az.slider.width/2){if(aq==aF.length-1){aw()}else{ae(aq+1,"easeOutExpo");aa()}}else{aw()}}else{if(Math.abs(a.left_adjust)>az.slider.width/2){if(aq==0){aw()}else{ae(aq-1,"easeOutExpo");aa()}}else{aw()}}}function ab(a){if(aq==aF.length-1){aw()}else{ae(aq+1);aa()}}function aj(a){if(aq==0){aw()}else{ae(aq-1);aa()}}function aC(a){switch(a.keyCode){case 39:ab(a);break;case 37:aj(a)}}function ad(f,b){if(ax.length==0){for(var d=0;d<aF.length;d++){ax.push(aF[d].leftpos())}}if(typeof b.left=="number"){var a=b.left,c=-aF[aq].leftpos();a<c-az.slider_width/3?ab():a>c+az.slider_width/3?aj():VMM.Lib.animate(ay,az.duration,az.ease,{left:c})}else{VMM.Lib.animate(ay,az.duration,az.ease,{left:c})}typeof b.top=="number"&&VMM.Lib.animate(ay,az.duration,az.ease,{top:-b.top})}function al(a){am()}function aa(){az.current_slide=aq;VMM.fireEvent(ap,"UPDATE")}function ac(a){aK=a}function aN(b){var a=0;VMM.attachElement(ar,"");aF=[];for(a=0;a<b.length;a++){var c=new VMM.Slider.Slide(b[a],ar);aF.push(c)}}function ai(b){var a=0;if(b){Z()}else{for(a=0;a<aF.length;a++){aF[a].clearTimers()}av=setTimeout(Z,az.duration)}}function Z(){var a=0;for(a=0;a<aF.length;a++){aF[a].enqueue=!0}for(a=0;a<az.preload;a++){if(!(aq+a>aF.length-1)){aF[aq+a].show();aF[aq+a].enqueue=!1}if(!(aq-a<0)){aF[aq-a].show();aF[aq-a].enqueue=!1}}if(aF.length>50){for(a=0;a<aF.length;a++){aF[a].enqueue&&aF[a].hide()}}ak()}function af(a){}function ak(){var g=0,c=".slider-item .layout-text-media .media .media-container ",f=".slider-item .layout-media .media .media-container ",b=".slider-item .media .media-container",d=".slider-item .media .media-container .media-shadow .caption",h=!1,a={text_media:{width:az.slider.content.width/100*60,height:az.slider.height-60,video:{width:0,height:0},text:{width:az.slider.content.width/100*40-30,height:az.slider.height}},media:{width:az.slider.content.width,height:az.slider.height-110,video:{width:0,height:0}}};if(VMM.Browser.device=="mobile"||aA<641){h=!0}VMM.master_config.sizes.api.width=a.media.width;VMM.master_config.sizes.api.height=a.media.height;a.text_media.video=VMM.Util.ratio.fit(a.text_media.width,a.text_media.height,16,9);a.media.video=VMM.Util.ratio.fit(a.media.width,a.media.height,16,9);VMM.Lib.css(".slider-item","width",az.slider.content.width);VMM.Lib.height(".slider-item",az.slider.height);if(h){a.text_media.width=az.slider.content.width-az.slider.content.padding*2;a.media.width=az.slider.content.width-az.slider.content.padding*2;a.text_media.height=az.slider.height/100*50-50;a.media.height=az.slider.height/100*70-40;a.text_media.video=VMM.Util.ratio.fit(a.text_media.width,a.text_media.height,16,9);a.media.video=VMM.Util.ratio.fit(a.media.width,a.media.height,16,9);VMM.Lib.css(".slider-item .layout-text-media .text","width","100%");VMM.Lib.css(".slider-item .layout-text-media .text","display","block");VMM.Lib.css(".slider-item .layout-text-media .text .container","display","block");VMM.Lib.css(".slider-item .layout-text-media .text .container","width",a.media.width);VMM.Lib.css(".slider-item .layout-text-media .text .container .start","width","auto");VMM.Lib.css(".slider-item .layout-text-media .media","float","none");VMM.Lib.addClass(".slider-item .content-container","pad-top");VMM.Lib.css(".slider-item .media blockquote p","line-height","18px");VMM.Lib.css(".slider-item .media blockquote p","font-size","16px");VMM.Lib.css(".slider-item","overflow-y","auto")}else{VMM.Lib.css(".slider-item .layout-text-media .text","width","40%");VMM.Lib.css(".slider-item .layout-text-media .text","display","table-cell");VMM.Lib.css(".slider-item .layout-text-media .text .container","display","table-cell");VMM.Lib.css(".slider-item .layout-text-media .text .container","width","auto");VMM.Lib.css(".slider-item .layout-text-media .text .container .start","width",a.text_media.text.width);VMM.Lib.removeClass(".slider-item .content-container","pad-top");VMM.Lib.css(".slider-item .layout-text-media .media","float","left");VMM.Lib.css(".slider-item .layout-text-media","display","table");VMM.Lib.css(".slider-item .media blockquote p","line-height","36px");VMM.Lib.css(".slider-item .media blockquote p","font-size","28px");VMM.Lib.css(".slider-item","display","table");VMM.Lib.css(".slider-item","overflow-y","auto")}VMM.Lib.css(c+".media-frame","max-width",a.text_media.width);VMM.Lib.height(c+".media-frame",a.text_media.height);VMM.Lib.width(c+".media-frame",a.text_media.width);VMM.Lib.css(c+"img","max-height",a.text_media.height);VMM.Lib.css(f+"img","max-height",a.media.height);VMM.Lib.css(c+"img","max-width",a.text_media.width);VMM.Lib.css(c+".avatar img","max-width",32);VMM.Lib.css(c+".avatar img","max-height",32);VMM.Lib.css(f+".avatar img","max-width",32);VMM.Lib.css(f+".avatar img","max-height",32);VMM.Lib.css(c+".article-thumb","max-width","50%");VMM.Lib.css(f+".article-thumb","max-width",200);VMM.Lib.width(c+".media-frame",a.text_media.video.width);VMM.Lib.height(c+".media-frame",a.text_media.video.height);VMM.Lib.width(f+".media-frame",a.media.video.width);VMM.Lib.height(f+".media-frame",a.media.video.height);VMM.Lib.css(f+".media-frame","max-height",a.media.video.height);VMM.Lib.css(f+".media-frame","max-width",a.media.video.width);VMM.Lib.height(f+".soundcloud",168);VMM.Lib.height(c+".soundcloud",168);VMM.Lib.width(f+".soundcloud",a.media.width);VMM.Lib.width(c+".soundcloud",a.text_media.width);VMM.Lib.css(b+".soundcloud","max-height",168);VMM.Lib.height(c+".map",a.text_media.height);VMM.Lib.width(c+".map",a.text_media.width);VMM.Lib.css(f+".map","max-height",a.media.height);VMM.Lib.width(f+".map",a.media.width);VMM.Lib.height(c+".doc",a.text_media.height);VMM.Lib.width(c+".doc",a.text_media.width);VMM.Lib.height(f+".doc",a.media.height);VMM.Lib.width(f+".doc",a.media.width);VMM.Lib.width(f+".wikipedia",a.media.width);VMM.Lib.width(f+".twitter",a.media.width);VMM.Lib.width(f+".plain-text-quote",a.media.width);VMM.Lib.width(f+".plain-text",a.media.width);VMM.Lib.css(b,"max-width",a.media.width);VMM.Lib.css(c+".caption","max-width",a.text_media.video.width);VMM.Lib.css(f+".caption","max-width",a.media.video.width);for(g=0;g<aF.length;g++){aF[g].layout(h);aF[g].content_height()>az.slider.height+20?aF[g].css("display","block"):aF[g].css("display","table")}}function aD(){var b=0,a=0;for(a=0;a<aF.length;a++){b=a*(az.slider.width+az.spacing);aF[a].leftpos(b)}}function ag(c){var a="linear",b=0;for(b=0;b<aF.length;b++){b==aq?aF[b].animate(az.duration,a,{opacity:1}):b==aq-1||b==aq+1?aF[b].animate(az.duration,a,{opacity:0.1}):aF[b].opacity(c)}}function ae(o,A,b,B,z){var w=az.ease,n=az.duration,j=!1,c=!1,q="",h;VMM.ExternalAPI.youtube.stopPlayers();aq=o;h=aF[aq].leftpos();aq==0&&(c=!0);aq+1>=aF.length&&(j=!0);A!=null&&A!=""&&(w=A);b!=null&&b!=""&&(n=b);if(VMM.Browser.device=="mobile"){VMM.Lib.visible(ah.prevBtn,!1);VMM.Lib.visible(ah.nextBtn,!1)}else{if(c){VMM.Lib.visible(ah.prevBtn,!1)}else{VMM.Lib.visible(ah.prevBtn,!0);q=VMM.Util.unlinkify(aK[aq-1].title);if(az.type=="timeline"){if(typeof aK[aq-1].date=="undefined"){VMM.attachElement(ah.prevDate,q);VMM.attachElement(ah.prevTitle,"")}else{VMM.attachElement(ah.prevDate,VMM.Date.prettyDate(aK[aq-1].startdate,!1,aK[aq-1].precisiondate));VMM.attachElement(ah.prevTitle,q)}}else{VMM.attachElement(ah.prevTitle,q)}}if(j){VMM.Lib.visible(ah.nextBtn,!1)}else{VMM.Lib.visible(ah.nextBtn,!0);q=VMM.Util.unlinkify(aK[aq+1].title);if(az.type=="timeline"){if(typeof aK[aq+1].date=="undefined"){VMM.attachElement(ah.nextDate,q);VMM.attachElement(ah.nextTitle,"")}else{VMM.attachElement(ah.nextDate,VMM.Date.prettyDate(aK[aq+1].startdate,!1,aK[aq+1].precisiondate));VMM.attachElement(ah.nextTitle,q)}}else{VMM.attachElement(ah.nextTitle,q)}}}if(B){VMM.Lib.css(ay,"left",-(h-az.slider.content.padding))}else{VMM.Lib.stop(ay);VMM.Lib.animate(ay,n,w,{left:-(h-az.slider.content.padding)})}z&&VMM.fireEvent(ap,"LOADED");if(aF[aq].height()>az.slider_height){VMM.Lib.css(".slider","overflow-y","scroll")}else{VMM.Lib.css(ap,"overflow-y","hidden");var k=0;try{k=VMM.Lib.prop(ap,"scrollHeight");VMM.Lib.animate(ap,n,w,{scrollTop:k-VMM.Lib.height(ap)})}catch(v){k=VMM.Lib.height(ap)}}ai();VMM.fireEvent(aE,"MESSAGE","TEST")}function aw(){VMM.Lib.stop(ay);VMM.Lib.animate(ay,az.duration,"easeOutExpo",{left:-aF[aq].leftpos()+az.slider.content.padding})}function Y(b,a,c){trace("showMessege "+a);VMM.attachElement(aH,"<div class='vco-explainer'><div class='vco-explainer-container'><div class='vco-bezel'><div class='vco-gesture-icon'></div><div class='vco-message'><p>"+a+"</p></div></div></div></div>")}function K(){VMM.Lib.animate(aH,az.duration,az.ease,{opacity:0},am)}function am(){VMM.Lib.detach(aH)}function J(){var a="<div class='icon'>&nbsp;</div>";ah.nextBtn=VMM.appendAndGetElement(aE,"<div>","nav-next");ah.prevBtn=VMM.appendAndGetElement(aE,"<div>","nav-previous");ah.nextBtnContainer=VMM.appendAndGetElement(ah.nextBtn,"<div>","nav-container",a);ah.prevBtnContainer=VMM.appendAndGetElement(ah.prevBtn,"<div>","nav-container",a);if(az.type=="timeline"){ah.nextDate=VMM.appendAndGetElement(ah.nextBtnContainer,"<div>","date","");ah.prevDate=VMM.appendAndGetElement(ah.prevBtnContainer,"<div>","date","")}ah.nextTitle=VMM.appendAndGetElement(ah.nextBtnContainer,"<div>","title","");ah.prevTitle=VMM.appendAndGetElement(ah.prevBtnContainer,"<div>","title","");VMM.bindEvent(".nav-next",ab);VMM.bindEvent(".nav-previous",aj);VMM.bindEvent(window,aC,"keydown")}function G(){var a=3000;VMM.attachElement(ap,"");aE=VMM.getElement(ap);au=VMM.appendAndGetElement(aE,"<div>","slider-container-mask");ay=VMM.appendAndGetElement(au,"<div>","slider-container");ar=VMM.appendAndGetElement(ay,"<div>","slider-item-container");J();aN(aK);if(VMM.Browser.device=="tablet"||VMM.Browser.device=="mobile"){az.duration=500;a=1000;aM=new VMM.DragSlider;aM.createPanel(aE,ay,"",az.touch,!0);VMM.bindEvent(aM,Q,"DRAGUPDATE");aH=VMM.appendAndGetElement(au,"<div>","vco-feedback","");Y(null,"Swipe to Navigate");VMM.Lib.height(aH,az.slider.height);VMM.bindEvent(aH,al);VMM.bindEvent(aH,al,"touchend")}ao(!1,!0);VMM.Lib.visible(ah.prevBtn,!1);ae(az.current_slide,"easeOutExpo",a,!0,!0);aL=!0}var az,av,aE,au,ay,ar,aM,aH,aB={},aK=[],aF=[],ax=[],aJ="",aq=0,aA=960,aG={move:!1,x:10,y:0,off:0,dampen:48},an="",aL=!1,ap=aI,ah={nextBtn:"",prevBtn:"",nextDate:"",prevDate:"",nextTitle:"",prevTitle:""};typeof at!="undefined"?az=at:az={preload:4,current_slide:0,interval:10,something:0,width:720,height:400,ease:"easeInOutExpo",duration:1000,timeline:!1,spacing:15,slider:{width:720,height:400,content:{width:720,height:400,padding:120,padding_default:120},nav:{width:100,height:200}}};this.ver="0.6";az.slider.width=az.width;az.slider.height=az.height;this.init=function(a){aF=[];ax=[];typeof a!="undefined"?this.setData(a):trace("WAITING ON DATA")};this.width=function(a){if(a==null||a==""){return az.slider.width}az.slider.width=a;ao()};this.height=function(a){if(a==null||a==""){return az.slider.height}az.slider.height=a;ao()};this.setData=function(a){if(typeof a!="undefined"){aK=a;G()}else{trace("NO DATA")}};this.getData=function(){return aK};this.setConfig=function(a){typeof a!="undefined"?az=a:trace("NO CONFIG DATA")};this.getConfig=function(){return az};this.setSize=function(b,a){b!=null&&(az.slider.width=b);a!=null&&(az.slider.height=a);aL&&ao()};this.active=function(){return aL};this.getCurrentNumber=function(){return aq};this.setSlide=function(a){ae(a)}});typeof VMM.Slider!="undefined"&&(VMM.Slider.Slide=function(R,F){var K,H,N,G,J,C,X=R,Q={},J="",M="",V=!1,O=!1,I=!1,U=!0,B=!1,L="slide_",P=0,q={pushque:"",render:"",relayout:"",remove:"",skinny:!1},W={pushque:500,render:100,relayout:100,remove:30000};L+=X.uniqueid;this.enqueue=U;this.id=L;J=VMM.appendAndGetElement(F,"<div>","slider-item");if(typeof X.classname!="undefined"){trace("HAS CLASSNAME");VMM.Lib.addClass(J,X.classname)}else{trace("NO CLASSNAME");trace(X)}C={slide:"",text:"",media:"",media_element:"",layout:"content-container layout",has:{headline:!1,text:!1,media:!1}};this.show=function(a){U=!1;q.skinny=a;B=!1;clearTimeout(q.remove);if(!V){if(O){clearTimeout(q.relayout);q.relayout=setTimeout(k,W.relayout)}else{A(a)}}};this.hide=function(){if(V&&!B){B=!0;clearTimeout(q.remove);q.remove=setTimeout(D,W.remove)}};this.clearTimers=function(){clearTimeout(q.relayout);clearTimeout(q.pushque);clearTimeout(q.render)};this.layout=function(a){V&&O&&z(a)};this.elem=function(){return J};this.position=function(){return VMM.Lib.position(J)};this.leftpos=function(a){if(typeof a=="undefined"){return VMM.Lib.position(J).left}VMM.Lib.css(J,"left",a)};this.animate=function(b,a,c){VMM.Lib.animate(J,b,a,c)};this.css=function(b,a){VMM.Lib.css(J,b,a)};this.opacity=function(a){VMM.Lib.css(J,"opacity",a)};this.width=function(){return VMM.Lib.width(J)};this.height=function(){return VMM.Lib.height(J)};this.content_height=function(){var a=VMM.Lib.find(J,".content")[0];return a!="undefined"&&a!=null?VMM.Lib.height(a):0};var A=function(a){trace("RENDER "+L);V=!0;O=!0;q.skinny=a;j();clearTimeout(q.pushque);clearTimeout(q.render);q.pushque=setTimeout(VMM.ExternalAPI.pushQues,W.pushque)},D=function(){trace("REMOVE SLIDE TIMER FINISHED");V=!1;VMM.Lib.detach(H);VMM.Lib.detach(K)},k=function(){V=!0;z(q.skinny,!0)},z=function(b,a){if(C.has.text){if(b){if(!I||a){VMM.Lib.removeClass(N,"pad-left");VMM.Lib.detach(H);VMM.Lib.detach(K);VMM.Lib.append(N,H);VMM.Lib.append(N,K);I=!0}}else{if(I||a){VMM.Lib.addClass(N,"pad-left");VMM.Lib.detach(H);VMM.Lib.detach(K);VMM.Lib.append(N,K);VMM.Lib.append(N,H);I=!1}}}else{if(a){if(C.has.headline){VMM.Lib.detach(H);VMM.Lib.append(N,H)}VMM.Lib.detach(K);VMM.Lib.append(N,K)}}},j=function(){trace("BUILDSLIDE");G=VMM.appendAndGetElement(J,"<div>","content");N=VMM.appendAndGetElement(G,"<div>");if(X.startdate!=null&&X.startdate!=""&&type.of(X.startdate)=="date"&&X.type!="start"){var c=VMM.Date.prettyDate(X.startdate,!1,X.precisiondate),a=VMM.Date.prettyDate(X.enddate,!1,X.precisiondate),b="";X.tag!=null&&X.tag!=""&&(b=VMM.createElement("span",X.tag,"slide-tag"));c!=a?C.text+=VMM.createElement("h2",c+" &mdash; "+a+b,"date"):C.text+=VMM.createElement("h2",c+b,"date")}if(X.headline!=null&&X.headline!=""){C.has.headline=!0;X.type=="start"?C.text+=VMM.createElement("h2",VMM.Util.linkify_with_twitter(X.headline,"_blank"),"start"):C.text+=VMM.createElement("h3",VMM.Util.linkify_with_twitter(X.headline,"_blank"))}if(X.text!=null&&X.text!=""){C.has.text=!0;C.text+=VMM.createElement("p",VMM.Util.linkify_with_twitter(X.text,"_blank"))}if(C.has.text||C.has.headline){C.text=VMM.createElement("div",C.text,"container");H=VMM.appendAndGetElement(N,"<div>","text",VMM.TextElement.create(C.text))}X.needs_slug;if(X.asset!=null&&X.asset!=""&&X.asset.media!=null&&X.asset.media!=""){C.has.media=!0;K=VMM.appendAndGetElement(N,"<div>","media",VMM.MediaElement.create(X.asset,X.uniqueid))}C.has.text&&(C.layout+="-text");C.has.media&&(C.layout+="-media");if(C.has.text){if(q.skinny){VMM.Lib.addClass(N,C.layout);I=!0}else{VMM.Lib.addClass(N,C.layout);VMM.Lib.addClass(N,"pad-left");VMM.Lib.detach(H);VMM.Lib.append(N,H)}}else{VMM.Lib.addClass(N,C.layout)}}});var Aes={};Aes.cipher=function(g,c){var j=4,f=c.length/j-1,b=[[],[],[],[]];for(var d=0;d<4*j;d++){b[d%4][Math.floor(d/4)]=g[d]}b=Aes.addRoundKey(b,c,0,j);for(var h=1;h<f;h++){b=Aes.subBytes(b,j);b=Aes.shiftRows(b,j);b=Aes.mixColumns(b,j);b=Aes.addRoundKey(b,c,h,j)}b=Aes.subBytes(b,j);b=Aes.shiftRows(b,j);b=Aes.addRoundKey(b,c,f,j);var a=new Array(4*j);for(var d=0;d<4*j;d++){a[d]=b[d%4][Math.floor(d/4)]}return a};Aes.keyExpansion=function(g){var k=4,d=g.length/4,b=d+6,f=new Array(k*(b+1)),l=new Array(4);for(var c=0;c<d;c++){var j=[g[4*c],g[4*c+1],g[4*c+2],g[4*c+3]];f[c]=j}for(var c=d;c<k*(b+1);c++){f[c]=new Array(4);for(var h=0;h<4;h++){l[h]=f[c-1][h]}if(c%d==0){l=Aes.subWord(Aes.rotWord(l));for(var h=0;h<4;h++){l[h]^=Aes.rCon[c/d][h]}}else{d>6&&c%d==4&&(l=Aes.subWord(l))}for(var h=0;h<4;h++){f[c][h]=f[c-d][h]^l[h]}}return f};Aes.subBytes=function(c,a){for(var d=0;d<4;d++){for(var b=0;b<a;b++){c[d][b]=Aes.sBox[c[d][b]]}}return c};Aes.shiftRows=function(d,b){var f=new Array(4);for(var c=1;c<4;c++){for(var a=0;a<4;a++){f[a]=d[c][(a+c)%b]}for(var a=0;a<4;a++){d[c][a]=f[a]}}return d};Aes.mixColumns=function(f,b){for(var g=0;g<4;g++){var d=new Array(4),a=new Array(4);for(var c=0;c<4;c++){d[c]=f[c][g];a[c]=f[c][g]&128?f[c][g]<<1^283:f[c][g]<<1}f[0][g]=a[0]^d[1]^a[1]^d[2]^d[3];f[1][g]=d[0]^a[1]^d[2]^a[2]^d[3];f[2][g]=d[0]^d[1]^a[2]^d[3]^a[3];f[3][g]=d[0]^a[0]^d[1]^d[2]^a[3]}return f};Aes.addRoundKey=function(f,b,g,d){for(var a=0;a<4;a++){for(var c=0;c<d;c++){f[a][c]^=b[g*4+c][a]}}return f};Aes.subWord=function(b){for(var a=0;a<4;a++){b[a]=Aes.sBox[b[a]]}return b};Aes.rotWord=function(b){var a=b[0];for(var c=0;c<3;c++){b[c]=b[c+1]}b[3]=a;return b};Aes.sBox=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22];Aes.rCon=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]];Aes.Ctr={};Aes.Ctr.encrypt=function(P,C,I){var F=16;if(I!=128&&I!=192&&I!=256){return""}P=Utf8.encode(P);C=Utf8.encode(C);var L=I/8,D=new Array(L);for(var H=0;H<L;H++){D[H]=isNaN(C.charCodeAt(H))?0:C.charCodeAt(H)}var A=Aes.cipher(D,Aes.keyExpansion(D));A=A.concat(A.slice(0,L-16));var U=new Array(F),O=(new Date).getTime(),K=O%1000,R=Math.floor(O/1000),M=Math.floor(Math.random()*65535);for(var H=0;H<2;H++){U[H]=K>>>H*8&255}for(var H=0;H<2;H++){U[H+2]=M>>>H*8&255}for(var H=0;H<4;H++){U[H+4]=R>>>H*8&255}var G="";for(var H=0;H<8;H++){G+=String.fromCharCode(U[H])}var Q=Aes.keyExpansion(A),z=Math.ceil(P.length/F),J=new Array(z);for(var N=0;N<z;N++){for(var k=0;k<4;k++){U[15-k]=N>>>k*8&255}for(var k=0;k<4;k++){U[15-k-4]=N/4294967296>>>k*8}var T=Aes.cipher(U,Q),q=N<z-1?F:(P.length-1)%F+1,B=new Array(q);for(var H=0;H<q;H++){B[H]=T[H]^P.charCodeAt(N*F+H);B[H]=String.fromCharCode(B[H])}J[N]=B.join("")}var j=G+J.join("");j=Base64.encode(j);return j};Aes.Ctr.decrypt=function(H,k,A){var w=16;if(A!=128&&A!=192&&A!=256){return""}H=Base64.decode(H);k=Utf8.encode(k);var D=A/8,q=new Array(D);for(var z=0;z<D;z++){q[z]=isNaN(k.charCodeAt(z))?0:k.charCodeAt(z)}var j=Aes.cipher(q,Aes.keyExpansion(q));j=j.concat(j.slice(0,D-16));var K=new Array(8);ctrTxt=H.slice(0,8);for(var z=0;z<8;z++){K[z]=ctrTxt.charCodeAt(z)}var G=Aes.keyExpansion(j),C=Math.ceil((H.length-8)/w),J=new Array(C);for(var E=0;E<C;E++){J[E]=H.slice(8+E*w,8+E*w+w)}H=J;var y=new Array(H.length);for(var E=0;E<C;E++){for(var I=0;I<4;I++){K[15-I]=E>>>I*8&255}for(var I=0;I<4;I++){K[15-I-4]=(E+1)/4294967296-1>>>I*8&255}var b=Aes.cipher(K,G),B=new Array(H[E].length);for(var z=0;z<H[E].length;z++){B[z]=b[z]^H[E].charCodeAt(z);B[z]=String.fromCharCode(B[z])}y[E]=B.join("")}var F=y.join("");F=Utf8.decode(F);return F};var Base64={};Base64.code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";Base64.encode=function(z,F){F=typeof F=="undefined"?!1:F;var k,b,q,G,j,E,C,y,m=[],B="",w,g,A,D=Base64.code;g=F?z.encodeUTF8():z;w=g.length%3;if(w>0){while(w++<3){B+="=";g+="\0"}}for(w=0;w<g.length;w+=3){k=g.charCodeAt(w);b=g.charCodeAt(w+1);q=g.charCodeAt(w+2);G=k<<16|b<<8|q;j=G>>18&63;E=G>>12&63;C=G>>6&63;y=G&63;m[w/3]=D.charAt(j)+D.charAt(E)+D.charAt(C)+D.charAt(y)}A=m.join("");A=A.slice(0,A.length-B.length)+B;return A};Base64.decode=function(y,D){D=typeof D=="undefined"?!1:D;var k,b,q,E,j,C,B,w,m=[],A,v,g=Base64.code;v=D?y.decodeUTF8():y;for(var z=0;z<v.length;z+=4){E=g.indexOf(v.charAt(z));j=g.indexOf(v.charAt(z+1));C=g.indexOf(v.charAt(z+2));B=g.indexOf(v.charAt(z+3));w=E<<18|j<<12|C<<6|B;k=w>>>16&255;b=w>>>8&255;q=w&255;m[z/4]=String.fromCharCode(k,b,q);B==64&&(m[z/4]=String.fromCharCode(k,b));C==64&&(m[z/4]=String.fromCharCode(k))}A=m.join("");return D?A.decodeUTF8():A};var Utf8={};Utf8.encode=function(b){var a=b.replace(/[\u0080-\u07ff]/g,function(d){var c=d.charCodeAt(0);return String.fromCharCode(192|c>>6,128|c&63)});a=a.replace(/[\u0800-\uffff]/g,function(d){var c=d.charCodeAt(0);return String.fromCharCode(224|c>>12,128|c>>6&63,128|c&63)});return a};Utf8.decode=function(b){var a=b.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(d){var c=(d.charCodeAt(0)&15)<<12|(d.charCodeAt(1)&63)<<6|d.charCodeAt(2)&63;return String.fromCharCode(c)});a=a.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(d){var c=(d.charCodeAt(0)&31)<<6|d.charCodeAt(1)&63;return String.fromCharCode(c)});return a};!function(b){var a=function(d,c){this.init("tooltip",d,c)};a.prototype={constructor:a,init:function(d,g,f){var c,e;this.type=d;this.$element=b(g);this.options=this.getOptions(f);this.enabled=!0;if(this.options.trigger!="manual"){c=this.options.trigger=="hover"?"mouseenter":"focus";e=this.options.trigger=="hover"?"mouseleave":"blur";this.$element.on(c,this.options.selector,b.proxy(this.enter,this));this.$element.on(e,this.options.selector,b.proxy(this.leave,this))}this.options.selector?this._options=b.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(c){c=b.extend({},b.fn[this.type].defaults,c,this.$element.data());c.delay&&typeof c.delay=="number"&&(c.delay={show:c.delay,hide:c.delay});return c},enter:function(c){var d=b(c.currentTarget)[this.type](this._options).data(this.type);if(!d.options.delay||!d.options.delay.show){d.show()}else{d.hoverState="in";setTimeout(function(){d.hoverState=="in"&&d.show()},d.options.delay.show)}},leave:function(c){var d=b(c.currentTarget)[this.type](this._options).data(this.type);if(!d.options.delay||!d.options.delay.hide){d.hide()}else{d.hoverState="out";setTimeout(function(){d.hoverState=="out"&&d.hide()},d.options.delay.hide)}},show:function(){var h,d,k,g,c,f,j;if(this.hasContent()&&this.enabled){h=this.tip();this.setContent();this.options.animation&&h.addClass("fade");f=typeof this.options.placement=="function"?this.options.placement.call(this,h[0],this.$element[0]):this.options.placement;d=/in/.test(f);h.remove().css({top:0,left:0,display:"block"}).appendTo(d?this.$element:document.body);k=this.getPosition(d);g=h[0].offsetWidth;c=h[0].offsetHeight;switch(d?f.split(" ")[1]:f){case"bottom":j={top:k.top+k.height,left:k.left+k.width/2-g/2};break;case"top":j={top:k.top-c,left:k.left+k.width/2-g/2};break;case"left":j={top:k.top+k.height/2-c/2,left:k.left-g};break;case"right":j={top:k.top+k.height/2-c/2,left:k.left+k.width}}h.css(j).addClass(f).addClass("in")}},setContent:function(){var c=this.tip();c.find(".timeline-tooltip-inner").html(this.getTitle());c.removeClass("fade in top bottom left right")},hide:function(){function d(){var f=setTimeout(function(){e.off(b.support.transition.end).remove()},500);e.one(b.support.transition.end,function(){clearTimeout(f);e.remove()})}var c=this,e=this.tip();e.removeClass("in");b.support.transition&&this.$tip.hasClass("fade")?d():e.remove()},fixTitle:function(){var c=this.$element;(c.attr("title")||typeof c.attr("data-original-title")!="string")&&c.attr("data-original-title",c.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getPosition:function(c){return b.extend({},c?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var d,c=this.$element,f=this.options;d=c.attr("data-original-title")||(typeof f.title=="function"?f.title.call(c[0]):f.title);d=d.toString().replace(/(^\s*|\s*$)/,"");return d},tip:function(){return this.$tip=this.$tip||b(this.options.template)},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null}},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()}};b.fn.tooltip=function(c){return this.each(function(){var f=b(this),d=f.data("tooltip"),e=typeof c=="object"&&c;d||f.data("tooltip",d=new a(this,e));typeof c=="string"&&d[c]()})};b.fn.tooltip.Constructor=a;b.fn.tooltip.defaults={animation:!0,delay:0,selector:!1,placement:"top",trigger:"hover",title:"",template:'<div class="timeline-tooltip"><div class="timeline-tooltip-arrow"></div><div class="timeline-tooltip-inner"></div></div>'}}(window.jQuery);typeof VMM!="undefined"&&typeof VMM.StoryJS=="undefined"&&(VMM.StoryJS=function(){this.init=function(a){}});if(typeof VMM!="undefined"&&typeof VMM.Timeline=="undefined"){VMM.Timeline=function(aG,aq,ax){function Q(a){typeof embed_config=="object"&&(timeline_config=embed_config);if(typeof timeline_config=="object"){trace("HAS TIMELINE CONFIG");ay=VMM.Util.mergeConfig(ay,timeline_config)}else{typeof a=="object"&&(ay=VMM.Util.mergeConfig(ay,a))}if(VMM.Browser.device=="mobile"||VMM.Browser.device=="tablet"){ay.touch=!0}ay.nav.width=ay.width;ay.nav.height=200;ay.feature.width=ay.width;ay.feature.height=ay.height-ay.nav.height;ay.nav.zoom.adjust=parseInt(ay.start_zoom_adjust,10);VMM.Timeline.Config=ay;VMM.master_config.Timeline=VMM.Timeline.Config;this.events=ay.events;ay.gmap_key!=""&&(ay.api_keys.google=ay.gmap_key);trace("VERSION "+ay.version);aI=ay.version}function am(){at=VMM.getElement(aD);VMM.Lib.addClass(at,"vco-timeline");VMM.Lib.addClass(at,"vco-storyjs");aC=VMM.appendAndGetElement(at,"<div>","vco-container vco-main");ar=VMM.appendAndGetElement(aC,"<div>","vco-feature");ap=VMM.appendAndGetElement(ar,"<div>","vco-slider");aK=VMM.appendAndGetElement(aC,"<div>","vco-navigation");aw=VMM.appendAndGetElement(at,"<div>","vco-feedback","");typeof ay.language.right_to_left!="undefined"&&VMM.Lib.addClass(at,"vco-right-to-left");aF=new VMM.Slider(ap,ay);az=new VMM.Timeline.TimeNav(aK);aE?VMM.Lib.width(at,ay.width):ay.width=VMM.Lib.width(at);al?VMM.Lib.height(at,ay.height):ay.height=VMM.Lib.height(at);ay.touch?VMM.Lib.addClass(at,"vco-touch"):VMM.Lib.addClass(at,"vco-notouch")}function K(b,a){trace("onDataReady");aH=a.timeline;type.of(aH.era)!="array"&&(aH.era=[]);G()}function Z(){J()}function ah(){ak();aF.setSize(ay.feature.width,ay.feature.height);az.setSize(ay.width,ay.height);aB()&&ad()}function aA(a){ay.loaded.slider=!0;ab()}function ab(a){ay.loaded.percentloaded=ay.loaded.percentloaded+25;ay.loaded.slider&&ay.loaded.timenav&&au()}function aj(a){ay.loaded.timenav=!0;ab()}function Y(a){an=!0;ay.current_slide=aF.getCurrentNumber();ag(ay.current_slide);az.setMarker(ay.current_slide,ay.ease,ay.duration)}function aa(a){an=!0;ay.current_slide=az.getCurrentNumber();ag(ay.current_slide);aF.setSlide(ay.current_slide)}function aL(a){if(a<=ao.length-1&&a>=0){ay.current_slide=a;aF.setSlide(ay.current_slide);az.setMarker(ay.current_slide,ay.ease,ay.duration)}}function ag(a){ay.hash_bookmark&&(window.location.hash="#"+a.toString())}function X(){}function ad(){var b="",a=ai(window.orientation);VMM.Browser.device=="mobile"?a=="portrait"?b="width=device-width; initial-scale=0.5, maximum-scale=0.5":a=="landscape"?b="width=device-width; initial-scale=0.5, maximum-scale=0.5":b="width=device-width, initial-scale=1, maximum-scale=1.0":VMM.Browser.device=="tablet";document.getElementById("viewport")}function ai(b){var a="";b==0||b==180?a="portrait":b==90||b==-90?a="landscape":a="normal";return a}function aB(){var a=ai(window.orientation);if(a==ay.orientation){return !1}ay.orientation=a;return !0}function ae(a){VMM.getJSON(a,function(b){aH=VMM.Timeline.DataObj.getData(b);VMM.fireEvent(global,ay.events.data_ready)})}function ac(b,a,c){trace("showMessege "+a);c?VMM.attachElement(aw,a):VMM.attachElement(aw,VMM.MediaElement.loadingmessage(a))}function au(){VMM.Lib.animate(aw,ay.duration,ay.ease*4,{opacity:0},V)}function V(){VMM.Lib.detach(aw)}function J(){parseInt(ay.start_at_slide)>0&&ay.current_slide==0&&(ay.current_slide=parseInt(ay.start_at_slide));ay.start_at_end&&ay.current_slide==0&&(ay.current_slide=ao.length-1);if(aJ){aJ=!0;VMM.fireEvent(global,ay.events.messege,"Internet Explorer "+VMM.Browser.version+" is not supported by TimelineJS. Please update your browser to version 8 or higher. If you are using a recent version of Internet Explorer you may need to disable compatibility mode in your browser.")}else{V();ah();VMM.bindEvent(ap,aA,"LOADED");VMM.bindEvent(aK,aj,"LOADED");VMM.bindEvent(ap,Y,"UPDATE");VMM.bindEvent(aK,aa,"UPDATE");aF.init(ao);az.init(ao,aH.era);VMM.bindEvent(global,ah,ay.events.resize)}}function ak(){trace("UPDATE SIZE");ay.width=VMM.Lib.width(at);ay.height=VMM.Lib.height(at);ay.nav.width=ay.width;ay.feature.width=ay.width;ay.feature.height=ay.height-ay.nav.height-3;VMM.Browser.device=="mobile";ay.width<641?VMM.Lib.addClass(at,"vco-skinny"):VMM.Lib.removeClass(at,"vco-skinny")}function G(){ao=[];VMM.fireEvent(global,ay.events.messege,"Building Dates");ak();for(var f=0;f<aH.date.length;f++){if(aH.date[f].startDate!=null&&aH.date[f].startDate!=""){var b={},h=VMM.Date.parse(aH.date[f].startDate,!0),d;b.startdate=h.date;b.precisiondate=h.precision;if(!isNaN(b.startdate)){aH.date[f].endDate!=null&&aH.date[f].endDate!=""?b.enddate=VMM.Date.parse(aH.date[f].endDate):b.enddate=b.startdate;b.needs_slug=!1;aH.date[f].headline==""&&aH.date[f].slug!=null&&aH.date[f].slug!=""&&(b.needs_slug=!0);b.title=aH.date[f].headline;b.headline=aH.date[f].headline;b.type=aH.date[f].type;b.date=VMM.Date.prettyDate(b.startdate,!1,b.precisiondate);b.asset=aH.date[f].asset;b.fulldate=b.startdate.getTime();b.text=aH.date[f].text;b.content="";b.tag=aH.date[f].tag;b.slug=aH.date[f].slug;b.uniqueid=VMM.Util.unique_ID(7);b.classname=aH.date[f].classname;ao.push(b)}}}aH.type!="storify"&&ao.sort(function(k,j){return k.fulldate-j.fulldate});if(aH.headline!=null&&aH.headline!=""&&aH.text!=null&&aH.text!=""){var a,h,b={},c=0,g;if(typeof aH.startDate!="undefined"){h=VMM.Date.parse(aH.startDate,!0);a=h.date}else{a=!1}trace("HAS STARTPAGE");trace(a);if(a&&a<ao[0].startdate){b.startdate=new Date(a)}else{g=ao[0].startdate;b.startdate=new Date(ao[0].startdate);g.getMonth()===0&&g.getDate()==1&&g.getHours()===0&&g.getMinutes()===0?b.startdate.setFullYear(g.getFullYear()-1):g.getDate()<=1&&g.getHours()===0&&g.getMinutes()===0?b.startdate.setMonth(g.getMonth()-1):g.getHours()===0&&g.getMinutes()===0?b.startdate.setDate(g.getDate()-1):g.getMinutes()===0?b.startdate.setHours(g.getHours()-1):b.startdate.setMinutes(g.getMinutes()-1)}b.uniqueid=VMM.Util.unique_ID(7);b.enddate=b.startdate;b.precisiondate=h.precision;b.title=aH.headline;b.headline=aH.headline;b.text=aH.text;b.type="start";b.date=VMM.Date.prettyDate(aH.startDate,!1,b.precisiondate);b.asset=aH.asset;b.slug=!1;b.needs_slug=!1;b.fulldate=b.startdate.getTime();ay.embed&&VMM.fireEvent(global,ay.events.headline,b.headline);ao.unshift(b)}aH.type!="storify"&&ao.sort(function(k,j){return k.fulldate-j.fulldate});Z()}var at,aC,ar,aw,ap,aK,aF,az,aI="2.x",aD="#timelinejs",av={},aH={},ao=[],ay={},aE=!1,al=!1,aJ=!1,an=!1;type.of(aG)=="string"?aG.match("#")?aD=aG:aD="#"+aG:aD="#timelinejs";ay={embed:!1,events:{data_ready:"DATAREADY",messege:"MESSEGE",headline:"HEADLINE",slide_change:"SLIDE_CHANGE",resize:"resize"},id:aD,source:"nothing",type:"timeline",touch:!1,orientation:"normal",maptype:"",version:"2.x",preload:4,current_slide:0,hash_bookmark:!1,start_at_end:!1,start_at_slide:0,start_zoom_adjust:0,start_page:!1,api_keys:{google:"",flickr:"",twitter:""},interval:10,something:0,width:960,height:540,spacing:15,loaded:{slider:!1,timenav:!1,percentloaded:0},nav:{start_page:!1,interval_width:200,density:4,minor_width:0,minor_left:0,constraint:{left:0,right:0,right_min:0,right_max:0},zoom:{adjust:0},multiplier:{current:6,min:0.1,max:50},rows:[1,1,1],width:960,height:200,marker:{width:150,height:50}},feature:{width:960,height:540},slider:{width:720,height:400,content:{width:720,height:400,padding:130,padding_default:130},nav:{width:100,height:200}},ease:"easeInOutExpo",duration:1000,gmap_key:"",language:VMM.Language};if(aq!=null&&aq!=""){ay.width=aq;aE=!0}if(ax!=null&&ax!=""){ay.height=ax;al=!0}if(window.location.hash){var af=window.location.hash.substring(1);isNaN(af)||(ay.current_slide=parseInt(af))}window.onhashchange=function(){var a=window.location.hash.substring(1);ay.hash_bookmark?an?aL(parseInt(a)):an=!1:aL(parseInt(a))};this.init=function(b,a){trace("INIT");ad();Q(b);am();type.of(a)=="string"&&(ay.source=a);VMM.Date.setLanguage(ay.language);VMM.master_config.language=ay.language;VMM.ExternalAPI.setKeys(ay.api_keys);VMM.ExternalAPI.googlemaps.setMapType(ay.maptype);VMM.bindEvent(global,K,ay.events.data_ready);VMM.bindEvent(global,ac,ay.events.messege);VMM.fireEvent(global,ay.events.messege,ay.language.messages.loading_timeline);(VMM.Browser.browser=="Explorer"||VMM.Browser.browser=="MSIE")&&parseInt(VMM.Browser.version,10)<=7&&(VMM.Browser.tridentVersion==null||VMM.Browser.tridentVersion<4)&&(aJ=!0);type.of(ay.source)=="string"||type.of(ay.source)=="object"?VMM.Timeline.DataObj.getData(ay.source):VMM.fireEvent(global,ay.events.messege,"No data source provided")};this.iframeLoaded=function(){trace("iframeLoaded")};this.reload=function(a){trace("Load new timeline data"+a);VMM.fireEvent(global,ay.events.messege,ay.language.messages.loading_timeline);aH={};VMM.Timeline.DataObj.getData(a);ay.current_slide=0;aF.setSlide(0);az.setMarker(0,ay.ease,ay.duration)}};VMM.Timeline.Config={}}typeof VMM.Timeline!="undefined"&&typeof VMM.Timeline.TimeNav=="undefined"&&(VMM.Timeline.TimeNav=function(bc,aU,a2){function af(){trace("onConfigSet")}function aO(a){bf.nav.constraint.left=bf.width/2;bf.nav.constraint.right=bf.nav.constraint.right_min-bf.width/2;aP.updateConstraint(bf.nav.constraint);VMM.Lib.css(a8,"left",Math.round(bf.width/2)+2);VMM.Lib.css(aY,"left",Math.round(bf.width/2)-8);ab(bf.current_slide,bf.ease,bf.duration,!0,a)}function ad(){VMM.fireEvent(aQ,"UPDATE")}function ac(){aP.cancelSlide();if(bf.nav.multiplier.current>bf.nav.multiplier.min){bf.nav.multiplier.current<=1?bf.nav.multiplier.current=bf.nav.multiplier.current-0.25:bf.nav.multiplier.current>5?bf.nav.multiplier.current>16?bf.nav.multiplier.current=Math.round(bf.nav.multiplier.current-10):bf.nav.multiplier.current=Math.round(bf.nav.multiplier.current-4):bf.nav.multiplier.current=Math.round(bf.nav.multiplier.current-1);bf.nav.multiplier.current<=0&&(bf.nav.multiplier.current=bf.nav.multiplier.min);ar()}}function ae(){aP.cancelSlide();if(bf.nav.multiplier.current<bf.nav.multiplier.max){bf.nav.multiplier.current>4?bf.nav.multiplier.current>16?bf.nav.multiplier.current=Math.round(bf.nav.multiplier.current+10):bf.nav.multiplier.current=Math.round(bf.nav.multiplier.current+4):bf.nav.multiplier.current=Math.round(bf.nav.multiplier.current+1);bf.nav.multiplier.current>=bf.nav.multiplier.max&&(bf.nav.multiplier.current=bf.nav.multiplier.max);ar()}}function aN(a){aP.cancelSlide();ab(0);ad()}function au(b){var a=0,c=0;b||(b=window.event);b.originalEvent&&(b=b.originalEvent);if(typeof b.wheelDeltaX!="undefined"){a=b.wheelDeltaY/6;Math.abs(b.wheelDeltaX)>Math.abs(b.wheelDeltaY)?a=b.wheelDeltaX/6:a=0}if(a){b.preventDefault&&b.preventDefault();b.returnValue=!1}c=VMM.Lib.position(aW).left+a;c>bf.nav.constraint.left?c=bf.width/2:c<bf.nav.constraint.right&&(c=bf.nav.constraint.right);VMM.Lib.css(aW,"left",c)}function ar(){trace("config.nav.multiplier "+bf.nav.multiplier.current);aM(!0);ai(!0);aH(bg,a5,!0,!0);aH(ba,aq,!0);bf.nav.constraint.left=bf.width/2;bf.nav.constraint.right=bf.nav.constraint.right_min-bf.width/2;aP.updateConstraint(bf.nav.constraint)}function al(a){aP.cancelSlide();ab(a.data.number);ad()}function az(a){VMM.Lib.toggleClass(a.data.elem,"zFront")}function ab(j,p,c,g,q){trace("GO TO MARKER");var b=bf.ease,m=bf.duration,k=!1,h=!1;an=j;ax.left=bf.width/2-aD[an].pos_left;ax.visible.left=Math.abs(ax.left)-100;ax.visible.right=Math.abs(ax.left)+bf.width+100;an==0&&(h=!0);an+1==aD.length&&(k=!0);p!=null&&p!=""&&(b=p);c!=null&&c!=""&&(m=c);for(var d=0;d<aD.length;d++){VMM.Lib.removeClass(aD[d].marker,"active")}if(bf.start_page&&aD[0].type=="start"){VMM.Lib.visible(aD[0].marker,!1);VMM.Lib.addClass(aD[0].marker,"start")}VMM.Lib.addClass(aD[an].marker,"active");VMM.Lib.stop(aW);VMM.Lib.animate(aW,m,b,{left:ax.left})}function aa(b,a){VMM.Lib.animate(aW,a.time/2,bf.ease,{left:a.left})}function aZ(){var f=0,b=0,g=0,d=[],a=0;for(a=0;a<aD.length;a++){if(ag[a].type!="start"){var c=aK(aA,aD[a].relative_pos),f=b;b=c.begin;g=b-f;d.push(g)}}return VMM.Util.average(d).mean}function bb(){var f=0,b=0,h="",d=0,a=[],c=!0,g=0;for(g=0;g<ag.length;g++){if(ag[g].type=="start"){trace("DATA DATE IS START")}else{h=ag[g].startdate;f=b;b=h;d=b-f;a.push(d)}}return VMM.Util.average(a)}function a7(){var b=bf.nav.multiplier.current,a=0;for(a=0;a<b;a++){aZ()<75&&bf.nav.multiplier.current>1&&(bf.nav.multiplier.current=bf.nav.multiplier.current-1)}}function aL(){var b=aI(ag[0].startdate),a=aI(ag[ag.length-1].enddate);aj.eon.type="eon";aj.eon.first=b.eons;aj.eon.base=Math.floor(b.eons);aj.eon.last=a.eons;aj.eon.number=ah.eons;aj.eon.multiplier=aE.eons;aj.eon.minor=aE.eons;aj.era.type="era";aj.era.first=b.eras;aj.era.base=Math.floor(b.eras);aj.era.last=a.eras;aj.era.number=ah.eras;aj.era.multiplier=aE.eras;aj.era.minor=aE.eras;aj.epoch.type="epoch";aj.epoch.first=b.epochs;aj.epoch.base=Math.floor(b.epochs);aj.epoch.last=a.epochs;aj.epoch.number=ah.epochs;aj.epoch.multiplier=aE.epochs;aj.epoch.minor=aE.epochs;aj.age.type="age";aj.age.first=b.ages;aj.age.base=Math.floor(b.ages);aj.age.last=a.ages;aj.age.number=ah.ages;aj.age.multiplier=aE.ages;aj.age.minor=aE.ages;aj.millenium.type="millenium";aj.millenium.first=b.milleniums;aj.millenium.base=Math.floor(b.milleniums);aj.millenium.last=a.milleniums;aj.millenium.number=ah.milleniums;aj.millenium.multiplier=aE.millenium;aj.millenium.minor=aE.millenium;aj.century.type="century";aj.century.first=b.centuries;aj.century.base=Math.floor(b.centuries);aj.century.last=a.centuries;aj.century.number=ah.centuries;aj.century.multiplier=aE.century;aj.century.minor=aE.century;aj.decade.type="decade";aj.decade.first=b.decades;aj.decade.base=Math.floor(b.decades);aj.decade.last=a.decades;aj.decade.number=ah.decades;aj.decade.multiplier=aE.decade;aj.decade.minor=aE.decade;aj.year.type="year";aj.year.first=b.years;aj.year.base=Math.floor(b.years);aj.year.last=a.years;aj.year.number=ah.years;aj.year.multiplier=1;aj.year.minor=aE.month;aj.month.type="month";aj.month.first=b.months;aj.month.base=Math.floor(b.months);aj.month.last=a.months;aj.month.number=ah.months;aj.month.multiplier=1;aj.month.minor=Math.round(aE.week);aj.week.type="week";aj.week.first=b.weeks;aj.week.base=Math.floor(b.weeks);aj.week.last=a.weeks;aj.week.number=ah.weeks;aj.week.multiplier=1;aj.week.minor=7;aj.day.type="day";aj.day.first=b.days;aj.day.base=Math.floor(b.days);aj.day.last=a.days;aj.day.number=ah.days;aj.day.multiplier=1;aj.day.minor=24;aj.hour.type="hour";aj.hour.first=b.hours;aj.hour.base=Math.floor(b.hours);aj.hour.last=a.hours;aj.hour.number=ah.hours;aj.hour.multiplier=1;aj.hour.minor=60;aj.minute.type="minute";aj.minute.first=b.minutes;aj.minute.base=Math.floor(b.minutes);aj.minute.last=a.minutes;aj.minute.number=ah.minutes;aj.minute.multiplier=1;aj.minute.minor=60;aj.second.type="decade";aj.second.first=b.seconds;aj.second.base=Math.floor(b.seconds);aj.second.last=a.seconds;aj.second.number=ah.seconds;aj.second.multiplier=1;aj.second.minor=10}function aI(b,a){var c={};c.days=b/a6.day;c.weeks=c.days/a6.week;c.months=c.days/a6.month;c.years=c.months/a6.year;c.hours=c.days*a6.hour;c.minutes=c.days*a6.minute;c.seconds=c.days*a6.second;c.decades=c.years/a6.decade;c.centuries=c.years/a6.century;c.milleniums=c.years/a6.millenium;c.ages=c.years/a6.age;c.epochs=c.years/a6.epoch;c.eras=c.years/a6.era;c.eons=c.years/a6.eon;return c}function ay(f,b,h){var d,a,c=f.type,g={start:"",end:"",type:c};d=aI(b);g.start=b.months;c=="eon"?g.start=d.eons:c=="era"?g.start=d.eras:c=="epoch"?g.start=d.epochs:c=="age"?g.start=d.ages:c=="millenium"?g.start=b.milleniums:c=="century"?g.start=d.centuries:c=="decade"?g.start=d.decades:c=="year"?g.start=d.years:c=="month"?g.start=d.months:c=="week"?g.start=d.weeks:c=="day"?g.start=d.days:c=="hour"?g.start=d.hours:c=="minute"&&(g.start=d.minutes);if(type.of(h)=="date"){a=aI(h);g.end=h.months;c=="eon"?g.end=a.eons:c=="era"?g.end=a.eras:c=="epoch"?g.end=a.epochs:c=="age"?g.end=a.ages:c=="millenium"?g.end=h.milleniums:c=="century"?g.end=a.centuries:c=="decade"?g.end=a.decades:c=="year"?g.end=a.years:c=="month"?g.end=a.months:c=="week"?g.end=a.weeks:c=="day"?g.end=a.days:c=="hour"?g.end=a.hours:c=="minute"&&(g.end=a.minutes)}else{g.end=g.start}return g}function aK(b,a){return{begin:(a.start-aA.base)*(bf.nav.interval_width/bf.nav.multiplier.current),end:(a.end-aA.base)*(bf.nav.interval_width/bf.nav.multiplier.current)}}function aM(N){var B=2,G=0,J=-2,C=0,F=0,z=150,Q=6,M=0,I=bf.width,P=[],K=6,D={left:ax.visible.left-I,right:ax.visible.right+I},O=0,r=0;bf.nav.minor_width=bf.width;VMM.Lib.removeClass(".flag","row1");VMM.Lib.removeClass(".flag","row2");VMM.Lib.removeClass(".flag","row3");for(O=0;O<aD.length;O++){var H,L=aD[O],j=aK(aA,aD[O].relative_pos),q=0,A=!1,b={id:O,pos:0,row:0},k=0;j.begin=Math.round(j.begin+J);j.end=Math.round(j.end+J);H=Math.round(j.end-j.begin);L.pos_left=j.begin;if(an==O){ax.left=bf.width/2-j;ax.visible.left=Math.abs(ax.left);ax.visible.right=Math.abs(ax.left)+bf.width;D.left=ax.visible.left-I;D.right=ax.visible.right+I}Math.abs(j.begin)>=D.left&&Math.abs(j.begin)<=D.right&&(A=!0);if(N){VMM.Lib.stop(L.marker);VMM.Lib.animate(L.marker,bf.duration/2,bf.ease,{left:j.begin})}else{VMM.Lib.stop(L.marker);VMM.Lib.css(L.marker,"left",j.begin)}O==an&&(M=j.begin);if(H>5){VMM.Lib.css(L.lineevent,"height",Q);VMM.Lib.css(L.lineevent,"top",z);N?VMM.Lib.animate(L.lineevent,bf.duration/2,bf.ease,{width:H}):VMM.Lib.css(L.lineevent,"width",H)}if(aF.length>0){for(r=0;r<aF.length;r++){if(r<bf.nav.rows.current.length&&L.tag==aF[r]){B=r;if(r==bf.nav.rows.current.length-1){trace("ON LAST ROW");VMM.Lib.addClass(L.flag,"flag-small-last")}}}q=bf.nav.rows.current[B]}else{if(j.begin-G.begin<bf.nav.marker.width+bf.spacing){if(B<bf.nav.rows.current.length-1){B++}else{B=0;C++}}else{C=1;B=1}q=bf.nav.rows.current[B]}G=j;b.pos=j;b.row=B;P.push(b);P.length>K&&VMM.Util.removeRange(P,0);if(N){VMM.Lib.stop(L.flag);VMM.Lib.animate(L.flag,bf.duration,bf.ease,{top:q})}else{VMM.Lib.stop(L.flag);VMM.Lib.css(L.flag,"top",q)}bf.start_page&&aD[O].type=="start"&&VMM.Lib.visible(L.marker,!1);j>bf.nav.minor_width&&(bf.nav.minor_width=j);j<bf.nav.minor_left&&(bf.nav.minor_left=j)}if(N){VMM.Lib.stop(aW);VMM.Lib.animate(aW,bf.duration/2,bf.ease,{left:bf.width/2-M})}}function ai(g){var k=0,d=0;for(k=0;k<ao.length;k++){var b=ao[k],f=aK(aA,b.relative_pos),l=0,c=0,j=bf.nav.marker.height*bf.nav.rows.full.length,h=f.end-f.begin;if(b.tag!=""){j=bf.nav.marker.height*bf.nav.rows.full.length/bf.nav.rows.current.length;for(d=0;d<aF.length;d++){d<bf.nav.rows.current.length&&b.tag==aF[d]&&(c=d)}l=bf.nav.rows.current[c]}else{l=-1}if(g){VMM.Lib.stop(b.content);VMM.Lib.stop(b.text_content);VMM.Lib.animate(b.content,bf.duration/2,bf.ease,{top:l,left:f.begin,width:h,height:j});VMM.Lib.animate(b.text_content,bf.duration/2,bf.ease,{left:f.begin})}else{VMM.Lib.stop(b.content);VMM.Lib.stop(b.text_content);VMM.Lib.css(b.content,"left",f.begin);VMM.Lib.css(b.content,"width",h);VMM.Lib.css(b.content,"height",j);VMM.Lib.css(b.content,"top",l);VMM.Lib.css(b.text_content,"left",f.begin)}}}function aH(C,I,k,b){var J=0,j=0,H=bf.width,F={left:ax.visible.left-H,right:ax.visible.right+H};not_too_many=!0,i=0;bf.nav.minor_left=0;if(I.length>100){not_too_many=!1;trace("TOO MANY "+I.length)}for(i=0;i<I.length;i++){var B=I[i].element,w=I[i].date,D=I[i].visible,z=aK(aA,I[i].relative_pos),d=z.begin,G=I[i].animation,q=!0,A=!1,E=50;G.pos=d;G.animate=!1;Math.abs(d)>=F.left&&Math.abs(d)<=F.right&&(A=!0);bf.nav.multiplier.current>16&&b?q=!1:d-J<65&&(d-J<35?i%4==0?d==0&&(q=!1):q=!1:VMM.Util.isEven(i)||(q=!1));if(q){if(I[i].is_detached){VMM.Lib.append(C,B);I[i].is_detached=!1}}else{I[i].is_detached=!0;VMM.Lib.detach(B)}if(D){if(!q){G.opacity="0";k&&not_too_many&&(G.animate=!0);I[i].interval_visible=!1}else{G.opacity="100";k&&A&&(G.animate=!0)}}else{G.opacity="100";if(q){k&&not_too_many?G.animate=!0:k&&A&&(G.animate=!0);I[i].interval_visible=!0}else{k&&not_too_many&&(G.animate=!0)}}J=d;d>bf.nav.minor_width&&(bf.nav.minor_width=d);d<bf.nav.minor_left&&(bf.nav.minor_left=d);if(G.animate){VMM.Lib.animate(B,bf.duration/2,bf.ease,{opacity:G.opacity,left:G.pos})}else{VMM.Lib.css(B,"opacity",G.opacity);VMM.Lib.css(B,"left",d)}}bf.nav.constraint.right_min=-bf.nav.minor_width+bf.width;bf.nav.constraint.right=bf.nav.constraint.right_min+bf.width/2;VMM.Lib.css(bd,"left",bf.nav.minor_left-bf.width/2);VMM.Lib.width(bd,bf.nav.minor_width+bf.width+Math.abs(bf.nav.minor_left))}function aJ(y,D,j){var b=0,m=!0,E=0,g=0,C,A,w,k=Math.ceil(y.number)+2,z={flag:!1,offset:0},q=0;VMM.attachElement(j,"");y.date=new Date(ag[0].startdate.getFullYear(),0,1,0,0,0);C=y.date.getTimezoneOffset();for(q=0;q<k;q++){trace(y.type);var d=!1,B={element:VMM.appendAndGetElement(j,"<div>",y.classname),date:new Date(ag[0].startdate.getFullYear(),0,1,0,0,0),visible:!1,date_string:"",type:y.interval_type,relative_pos:0,is_detached:!1,animation:{animate:!1,pos:"",opacity:"100"}};if(y.type=="eon"){m&&(A=Math.floor(ag[0].startdate.getFullYear()/500000000)*500000000);B.date.setFullYear(A+b*500000000);d=!0}else{if(y.type=="era"){m&&(A=Math.floor(ag[0].startdate.getFullYear()/100000000)*100000000);B.date.setFullYear(A+b*100000000);d=!0}else{if(y.type=="epoch"){m&&(A=Math.floor(ag[0].startdate.getFullYear()/10000000)*10000000);B.date.setFullYear(A+b*10000000);d=!0}else{if(y.type=="age"){m&&(A=Math.floor(ag[0].startdate.getFullYear()/1000000)*1000000);B.date.setFullYear(A+b*1000000);d=!0}else{if(y.type=="millenium"){m&&(A=Math.floor(ag[0].startdate.getFullYear()/1000)*1000);B.date.setFullYear(A+b*1000);d=!0}else{if(y.type=="century"){m&&(A=Math.floor(ag[0].startdate.getFullYear()/100)*100);B.date.setFullYear(A+b*100);d=!0}else{if(y.type=="decade"){m&&(A=Math.floor(ag[0].startdate.getFullYear()/10)*10);B.date.setFullYear(A+b*10);d=!0}else{if(y.type=="year"){m&&(A=ag[0].startdate.getFullYear());B.date.setFullYear(A+b);d=!0}else{if(y.type=="month"){m&&(A=ag[0].startdate.getMonth());B.date.setMonth(A+b)}else{if(y.type=="week"){m&&(A=ag[0].startdate.getMonth());B.date.setMonth(ag[0].startdate.getMonth());B.date.setDate(A+b*7)}else{if(y.type=="day"){m&&(A=ag[0].startdate.getDate());B.date.setMonth(ag[0].startdate.getMonth());B.date.setDate(A+b)}else{if(y.type=="hour"){m&&(A=ag[0].startdate.getHours());B.date.setMonth(ag[0].startdate.getMonth());B.date.setDate(ag[0].startdate.getDate());B.date.setHours(A+b)}else{if(y.type=="minute"){m&&(A=ag[0].startdate.getMinutes());B.date.setMonth(ag[0].startdate.getMonth());B.date.setDate(ag[0].startdate.getDate());B.date.setHours(ag[0].startdate.getHours());B.date.setMinutes(A+b)}else{if(y.type=="second"){m&&(A=ag[0].startdate.getSeconds());B.date.setMonth(ag[0].startdate.getMonth());B.date.setDate(ag[0].startdate.getDate());B.date.setHours(ag[0].startdate.getHours());B.date.setMinutes(ag[0].startdate.getMinutes());B.date.setSeconds(A+b)}else{if(y.type=="millisecond"){m&&(A=ag[0].startdate.getMilliseconds());B.date.setMonth(ag[0].startdate.getMonth());B.date.setDate(ag[0].startdate.getDate());B.date.setHours(ag[0].startdate.getHours());B.date.setMinutes(ag[0].startdate.getMinutes());B.date.setSeconds(ag[0].startdate.getSeconds());B.date.setMilliseconds(A+b)}}}}}}}}}}}}}}}if(VMM.Browser.browser=="Firefox"){if(B.date.getFullYear()=="1970"&&B.date.getTimezoneOffset()!=C){trace("FIREFOX 1970 TIMEZONE OFFSET "+B.date.getTimezoneOffset()+" SHOULD BE "+C);trace(y.type+" "+y.date);z.offset=B.date.getTimezoneOffset()/60;z.flag=!0;B.date.setHours(B.date.getHours()+z.offset)}else{if(z.flag){z.flag=!1;B.date.setHours(B.date.getHours()+z.offset);d&&(z.flag=!0)}}}d?B.date.getFullYear()<0?B.date_string=Math.abs(B.date.getFullYear()).toString()+" B.C.":B.date_string=B.date.getFullYear():B.date_string=VMM.Date.prettyDate(B.date,!0);b+=1;m=!1;B.relative_pos=ay(aA,B.date);E=B.relative_pos.begin;B.relative_pos.begin>g&&(g=B.relative_pos.begin);VMM.appendElement(B.element,B.date_string);VMM.Lib.css(B.element,"text-indent",-(VMM.Lib.width(B.element)/2));VMM.Lib.css(B.element,"opacity","0");D.push(B)}VMM.Lib.width(bd,g);aH(j,D)}function aG(){var b=0,a=0;VMM.attachElement(aQ,"");aW=VMM.appendAndGetElement(aQ,"<div>","timenav");aV=VMM.appendAndGetElement(aW,"<div>","content");a0=VMM.appendAndGetElement(aW,"<div>","time");aT=VMM.appendAndGetElement(a0,"<div>","time-interval-minor");bd=VMM.appendAndGetElement(aT,"<div>","minor");ba=VMM.appendAndGetElement(a0,"<div>","time-interval-major");bg=VMM.appendAndGetElement(a0,"<div>","time-interval");a4=VMM.appendAndGetElement(aQ,"<div>","timenav-background");a8=VMM.appendAndGetElement(a4,"<div>","timenav-line");aY=VMM.appendAndGetElement(a4,"<div>","timenav-indicator");be=VMM.appendAndGetElement(a4,"<div>","timenav-interval-background","<div class='top-highlight'></div>");aS=VMM.appendAndGetElement(aQ,"<div>","vco-toolbar");a1();aw();ak();a7();aM(!1);ai();aH(bg,a5,!1,!0);aH(ba,aq);if(bf.start_page){$backhome=VMM.appendAndGetElement(aS,"<div>","back-home","<div class='icon'></div>");VMM.bindEvent(".back-home",aN,"click");VMM.Lib.attribute($backhome,"title",VMM.master_config.language.messages.return_to_title);VMM.Lib.attribute($backhome,"rel","timeline-tooltip")}aP=new VMM.DragSlider;aP.createPanel(aQ,aW,bf.nav.constraint,bf.touch);if(bf.touch&&bf.start_page){VMM.Lib.addClass(aS,"touch");VMM.Lib.css(aS,"top",55);VMM.Lib.css(aS,"left",10)}else{bf.start_page&&VMM.Lib.css(aS,"top",27);a3=VMM.appendAndGetElement(aS,"<div>","zoom-in","<div class='icon'></div>");a9=VMM.appendAndGetElement(aS,"<div>","zoom-out","<div class='icon'></div>");VMM.bindEvent(a3,ac,"click");VMM.bindEvent(a9,ae,"click");VMM.Lib.attribute(a3,"title",VMM.master_config.language.messages.expand_timeline);VMM.Lib.attribute(a3,"rel","timeline-tooltip");VMM.Lib.attribute(a9,"title",VMM.master_config.language.messages.contract_timeline);VMM.Lib.attribute(a9,"rel","timeline-tooltip");aS.tooltip({selector:"div[rel=timeline-tooltip]",placement:"right"});VMM.bindEvent(aQ,au,"DOMMouseScroll");VMM.bindEvent(aQ,au,"mousewheel")}if(bf.nav.zoom.adjust!=0){if(bf.nav.zoom.adjust<0){for(b=0;b<Math.abs(bf.nav.zoom.adjust);b++){ae()}}else{for(a=0;a<bf.nav.zoom.adjust;a++){ac()}}}ap=!0;aO(!0);VMM.fireEvent(aQ,"LOADED")}function a1(){var b=0,a=0;ah=aI(ag[ag.length-1].enddate-ag[0].startdate,!0);trace(ah);aL();if(ah.centuries>ag.length/bf.nav.density){aA=aj.century;av=aj.millenium;aX=aj.decade}else{if(ah.decades>ag.length/bf.nav.density){aA=aj.decade;av=aj.century;aX=aj.year}else{if(ah.years>ag.length/bf.nav.density){aA=aj.year;av=aj.decade;aX=aj.month}else{if(ah.months>ag.length/bf.nav.density){aA=aj.month;av=aj.year;aX=aj.day}else{if(ah.days>ag.length/bf.nav.density){aA=aj.day;av=aj.month;aX=aj.hour}else{if(ah.hours>ag.length/bf.nav.density){aA=aj.hour;av=aj.day;aX=aj.minute}else{if(ah.minutes>ag.length/bf.nav.density){aA=aj.minute;av=aj.hour;aX=aj.second}else{if(ah.seconds>ag.length/bf.nav.density){aA=aj.second;av=aj.minute;aX=aj.second}else{trace("NO IDEA WHAT THE TYPE SHOULD BE");aA=aj.day;av=aj.month;aX=aj.hour}}}}}}}}trace("INTERVAL TYPE: "+aA.type);trace("INTERVAL MAJOR TYPE: "+av.type);aJ(aA,a5,bg);aJ(av,aq,ba);for(b=0;b<a5.length;b++){for(a=0;a<aq.length;a++){a5[b].date_string==aq[a].date_string&&VMM.attachElement(a5[b].element,"")}}}function aw(){var B=2,I=0,l=0,b=0,s=0,k=0;aD=[];ao=[];for(b=0;b<ag.length;b++){var H,F,A,D,w,j,C,G="",q=!1;H=VMM.appendAndGetElement(aV,"<div>","marker");F=VMM.appendAndGetElement(H,"<div>","flag");A=VMM.appendAndGetElement(F,"<div>","flag-content");D=VMM.appendAndGetElement(H,"<div>","dot");w=VMM.appendAndGetElement(H,"<div>","line");j=VMM.appendAndGetElement(w,"<div>","event-line");_marker_relative_pos=ay(aA,ag[b].startdate,ag[b].enddate);_marker_thumb="";ag[b].asset!=null&&ag[b].asset!=""?VMM.appendElement(A,VMM.MediaElement.thumbnail(ag[b].asset,24,24,ag[b].uniqueid)):VMM.appendElement(A,"<div style='margin-right:7px;height:50px;width:2px;float:left;'></div>");if(ag[b].title==""||ag[b].title==" "){trace("TITLE NOTHING");if(typeof ag[b].slug!="undefined"&&ag[b].slug!=""){trace("SLUG");G=VMM.Util.untagify(ag[b].slug);q=!0}else{var z=VMM.MediaType(ag[b].asset.media);if(z.type=="quote"||z.type=="unknown"){G=VMM.Util.untagify(z.id);q=!0}else{q=!1}}}else{if(ag[b].title!=""||ag[b].title!=" "){trace(ag[b].title);G=VMM.Util.untagify(ag[b].title);q=!0}else{trace("TITLE SLUG NOT FOUND "+ag[b].slug)}}if(q){VMM.appendElement(A,"<h3>"+G+"</h3>")}else{VMM.appendElement(A,"<h3>"+G+"</h3>");VMM.appendElement(A,"<h3 id='marker_content_"+ag[b].uniqueid+"'>"+G+"</h3>")}VMM.Lib.attr(H,"id",("marker_"+ag[b].uniqueid).toString());VMM.bindEvent(F,al,"",{number:b});VMM.bindEvent(F,az,"mouseenter mouseleave",{number:b,elem:F});C={marker:H,flag:F,lineevent:j,type:"marker",full:!0,relative_pos:_marker_relative_pos,tag:ag[b].tag,pos_left:0};if(ag[b].type=="start"){trace("BUILD MARKER HAS START PAGE");bf.start_page=!0;C.type="start"}ag[b].type=="storify"&&(C.type="storify");ag[b].tag&&aF.push(ag[b].tag);aD.push(C)}aF=VMM.Util.deDupeArray(aF);aF.length>3?bf.nav.rows.current=bf.nav.rows.half:bf.nav.rows.current=bf.nav.rows.full;for(s=0;s<aF.length;s++){if(s<bf.nav.rows.current.length){var E=VMM.appendAndGetElement(a4,"<div>","timenav-tag");VMM.Lib.addClass(E,"timenav-tag-row-"+(s+1));aF.length>3?VMM.Lib.addClass(E,"timenav-tag-size-half"):VMM.Lib.addClass(E,"timenav-tag-size-full");VMM.appendElement(E,"<div><h3>"+aF[s]+"</h3></div>")}}if(aF.length>3){for(k=0;k<aD.length;k++){VMM.Lib.addClass(aD[k].flag,"flag-small");aD[k].full=!1}}}function ak(){var f=6,c=0,h=0;for(h=0;h<bh.length;h++){var d={content:VMM.appendAndGetElement(aV,"<div>","era"),text_content:VMM.appendAndGetElement(bg,"<div>","era"),startdate:VMM.Date.parse(bh[h].startDate),enddate:VMM.Date.parse(bh[h].endDate),title:bh[h].headline,uniqueid:VMM.Util.unique_ID(6),tag:"",relative_pos:""},b=VMM.Date.prettyDate(d.startdate),g=VMM.Date.prettyDate(d.enddate),a="<div>&nbsp;</div>";typeof bh[h].tag!="undefined"&&(d.tag=bh[h].tag);d.relative_pos=ay(aA,d.startdate,d.enddate);VMM.Lib.attr(d.content,"id",d.uniqueid);VMM.Lib.attr(d.text_content,"id",d.uniqueid+"_text");VMM.Lib.addClass(d.content,"era"+(c+1));VMM.Lib.addClass(d.text_content,"era"+(c+1));c<f?c++:c=0;VMM.appendElement(d.content,a);VMM.appendElement(d.text_content,VMM.Util.unlinkify(d.title));ao.push(d)}}trace("VMM.Timeline.TimeNav");var aW,aV,a0,aT,bg,ba,a4,be,a8,aY,bd,aS,a3,a9,aP,bf=VMM.Timeline.Config,aR,aB={},ah={},aQ=bc,ag=[],ao=[],aD=[],a5=[],aq=[],aF=[],an=0,ap=!1,bh,aC,am={interval_position:""},ax={left:"",visible:{left:"",right:""}},aE={day:24,month:12,year:10,hour:60,minute:60,second:1000,decade:10,century:100,millenium:1000,age:1000000,epoch:10000000,era:100000000,eon:500000000,week:4.34812141,days_in_month:30.4368499,days_in_week:7,weeks_in_month:4.34812141,weeks_in_year:52.177457,days_in_year:365.242199,hours_in_day:24},a6={day:86400000,week:7,month:30.4166666667,year:12,hour:24,minute:1440,second:86400,decade:10,century:100,millenium:1000,age:1000000,epoch:10000000,era:100000000,eon:500000000},aA={type:"year",number:10,first:1970,last:2011,multiplier:100,classname:"_idd",interval_type:"interval"},av={type:"year",number:10,first:1970,last:2011,multiplier:100,classname:"major",interval_type:"interval major"},aX={type:"year",number:10,first:1970,last:2011,multiplier:100,classname:"_dd_minor",interval_type:"interval minor"},aj={day:{},month:{},year:{},hour:{},minute:{},second:{},decade:{},century:{},millenium:{},week:{},age:{},epoch:{},era:{},eon:{}};aR=bf.nav.marker.height/2;bf.nav.rows={full:[1,aR*2,aR*4],half:[1,aR,aR*2,aR*3,aR*4,aR*5],current:[]};aU!=null&&aU!=""&&(bf.nav.width=aU);a2!=null&&a2!=""&&(bf.nav.height=a2);this.init=function(b,a){trace("VMM.Timeline.TimeNav init");typeof b!="undefined"?this.setData(b,a):trace("WAITING ON DATA")};this.setData=function(b,a){if(typeof b!="undefined"){ag={};ag=b;bh=a;aG()}else{trace("NO DATA")}};this.setSize=function(b,a){b!=null&&(bf.width=b);a!=null&&(bf.height=a);ap&&aO()};this.setMarker=function(c,a,d,b){ab(c,a,d)};this.getCurrentNumber=function(){return an}});typeof VMM.Timeline!="undefined"&&typeof VMM.Timeline.DataObj=="undefined"&&(VMM.Timeline.DataObj={data_obj:{},model_array:[],getData:function(b){VMM.Timeline.DataObj.data_obj={};VMM.fireEvent(global,VMM.Timeline.Config.events.messege,VMM.Timeline.Config.language.messages.loading_timeline);if(type.of(b)=="object"){trace("DATA SOURCE: JSON OBJECT");VMM.Timeline.DataObj.parseJSON(b)}else{if(type.of(b)=="string"){if(b.match("%23")){trace("DATA SOURCE: TWITTER SEARCH");VMM.Timeline.DataObj.model.tweets.getData("%23medill")}else{if(b.match("spreadsheet")){trace("DATA SOURCE: GOOGLE SPREADSHEET");VMM.Timeline.DataObj.model.googlespreadsheet.getData(b)}else{if(b.match("storify.com")){trace("DATA SOURCE: STORIFY");VMM.Timeline.DataObj.model.storify.getData(b)}else{if(b.match(".jsonp")){trace("DATA SOURCE: JSONP");LoadLib.js(b,VMM.Timeline.DataObj.onJSONPLoaded)}else{trace("DATA SOURCE: JSON");var a="";b.indexOf("?")>-1?a=b+"&callback=onJSONP_Data":a=b+"?callback=onJSONP_Data";VMM.getJSON(a,VMM.Timeline.DataObj.parseJSON)}}}}}else{if(type.of(b)=="html"){trace("DATA SOURCE: HTML");VMM.Timeline.DataObj.parseHTML(b)}else{trace("DATA SOURCE: UNKNOWN")}}}},onJSONPLoaded:function(){trace("JSONP IS LOADED");VMM.fireEvent(global,VMM.Timeline.Config.events.data_ready,storyjs_jsonp_data)},parseHTML:function(b){trace("parseHTML");trace("WARNING: THIS IS STILL ALPHA AND WILL NOT WORK WITH ID's other than #timeline");var a=VMM.Timeline.DataObj.data_template_obj;if(VMM.Lib.find("#timeline section","time")[0]){a.timeline.startDate=VMM.Lib.html(VMM.Lib.find("#timeline section","time")[0]);a.timeline.headline=VMM.Lib.html(VMM.Lib.find("#timeline section","h2"));a.timeline.text=VMM.Lib.html(VMM.Lib.find("#timeline section","article"));var c=!1;if(VMM.Lib.find("#timeline section","figure img").length!=0){c=!0;a.timeline.asset.media=VMM.Lib.attr(VMM.Lib.find("#timeline section","figure img"),"src")}else{if(VMM.Lib.find("#timeline section","figure a").length!=0){c=!0;a.timeline.asset.media=VMM.Lib.attr(VMM.Lib.find("#timeline section","figure a"),"href")}}if(c){VMM.Lib.find("#timeline section","cite").length!=0&&(a.timeline.asset.credit=VMM.Lib.html(VMM.Lib.find("#timeline section","cite")));VMM.Lib.find(this,"figcaption").length!=0&&(a.timeline.asset.caption=VMM.Lib.html(VMM.Lib.find("#timeline section","figcaption")))}}VMM.Lib.each("#timeline li",function(h,j){var g=!1,d={type:"default",startDate:"",headline:"",text:"",asset:{media:"",credit:"",caption:""},tags:"Optional"};if(VMM.Lib.find(this,"time")!=0){g=!0;d.startDate=VMM.Lib.html(VMM.Lib.find(this,"time")[0]);VMM.Lib.find(this,"time")[1]&&(d.endDate=VMM.Lib.html(VMM.Lib.find(this,"time")[1]));d.headline=VMM.Lib.html(VMM.Lib.find(this,"h3"));d.text=VMM.Lib.html(VMM.Lib.find(this,"article"));var f=!1;if(VMM.Lib.find(this,"figure img").length!=0){f=!0;d.asset.media=VMM.Lib.attr(VMM.Lib.find(this,"figure img"),"src")}else{if(VMM.Lib.find(this,"figure a").length!=0){f=!0;d.asset.media=VMM.Lib.attr(VMM.Lib.find(this,"figure a"),"href")}}if(f){VMM.Lib.find(this,"cite").length!=0&&(d.asset.credit=VMM.Lib.html(VMM.Lib.find(this,"cite")));VMM.Lib.find(this,"figcaption").length!=0&&(d.asset.caption=VMM.Lib.html(VMM.Lib.find(this,"figcaption")))}trace(d);a.timeline.date.push(d)}});VMM.fireEvent(global,VMM.Timeline.Config.events.data_ready,a)},parseJSON:function(a){trace("parseJSON");if(a.timeline.type=="default"){trace("DATA SOURCE: JSON STANDARD TIMELINE");VMM.fireEvent(global,VMM.Timeline.Config.events.data_ready,a)}else{if(a.timeline.type=="twitter"){trace("DATA SOURCE: JSON TWEETS");VMM.Timeline.DataObj.model_Tweets.buildData(a)}else{trace("DATA SOURCE: UNKNOWN JSON");trace(type.of(a.timeline))}}},model:{googlespreadsheet:{extractSpreadsheetKey:function(c){var a=VMM.Util.getUrlVars(c).key;if(!a&&c.match("docs.google.com/spreadsheets/d/")){var d=c.indexOf("docs.google.com/spreadsheets/d/")+"docs.google.com/spreadsheets/d/".length,b=c.substr(d);a=b.split("/")[0]}a||(a=c);return a},getData:function(g){function a(){c=VMM.getJSON(b,function(k){clearTimeout(d);VMM.Timeline.DataObj.model.googlespreadsheet.buildData(k)}).error(function(l,k,m){if(l.status==400){VMM.fireEvent(global,VMM.Timeline.Config.events.messege,"Error reading Google spreadsheet. Check the URL and make sure it's published to the web.");clearTimeout(d);return}trace("Google Docs ERROR");trace("Google Docs ERROR: "+k+" "+l.responseText)}).success(function(k){clearTimeout(d)})}var c,j,f,b,d,h=0;j=VMM.Timeline.DataObj.model.googlespreadsheet.extractSpreadsheetKey(g);f=VMM.Util.getUrlVars(g).worksheet;typeof f=="undefined"&&(f="od6");b="https://spreadsheets.google.com/feeds/list/"+j+"/"+f+"/public/values?alt=json";d=setTimeout(function(){trace("Google Docs timeout "+b);trace(b);if(h<3){VMM.fireEvent(global,VMM.Timeline.Config.events.messege,"Still waiting on Google Docs, trying again "+h);h++;c.abort();a()}else{VMM.fireEvent(global,VMM.Timeline.Config.events.messege,"Google Docs is not responding")}},16000);a()},buildData:function(g){function b(a){return typeof a!="undefined"?a.$t:""}var k=VMM.Timeline.DataObj.data_template_obj,d=!1;VMM.fireEvent(global,VMM.Timeline.Config.events.messege,"Parsing Google Doc Data");if(typeof g.feed.entry=="undefined"){VMM.fireEvent(global,VMM.Timeline.Config.events.messege,"Error parsing spreadsheet. Make sure you have no blank rows and that the headers have not been changed.")}else{d=!0;for(var f=0;f<g.feed.entry.length;f++){var l=g.feed.entry[f],c="";typeof l.gsx$type!="undefined"?c=l.gsx$type.$t:typeof l.gsx$titleslide!="undefined"&&(c=l.gsx$titleslide.$t);if(c.match("start")||c.match("title")){k.timeline.startDate=b(l.gsx$startdate);k.timeline.headline=b(l.gsx$headline);k.timeline.asset.media=b(l.gsx$media);k.timeline.asset.caption=b(l.gsx$mediacaption);k.timeline.asset.credit=b(l.gsx$mediacredit);k.timeline.text=b(l.gsx$text);k.timeline.type="google spreadsheet"}else{if(c.match("era")){var j={startDate:b(l.gsx$startdate),endDate:b(l.gsx$enddate),headline:b(l.gsx$headline),text:b(l.gsx$text),tag:b(l.gsx$tag)};k.timeline.era.push(j)}else{var h={type:"google spreadsheet",startDate:b(l.gsx$startdate),endDate:b(l.gsx$enddate),headline:b(l.gsx$headline),text:b(l.gsx$text),tag:b(l.gsx$tag),asset:{media:b(l.gsx$media),credit:b(l.gsx$mediacredit),caption:b(l.gsx$mediacaption),thumbnail:b(l.gsx$mediathumbnail)}};k.timeline.date.push(h)}}}}if(d){VMM.fireEvent(global,VMM.Timeline.Config.events.messege,"Finished Parsing Data");VMM.fireEvent(global,VMM.Timeline.Config.events.data_ready,k)}else{VMM.fireEvent(global,VMM.Timeline.Config.events.messege,VMM.Language.messages.loading+" Google Doc Data (cells)");trace("There may be too many entries. Still trying to load data. Now trying to load cells to avoid Googles limitation on cells");VMM.Timeline.DataObj.model.googlespreadsheet.getDataCells(g.feed.link[0].href)}},getDataCells:function(f){function g(){b=VMM.getJSON(d,function(j){clearTimeout(a);VMM.Timeline.DataObj.model.googlespreadsheet.buildDataCells(j)}).error(function(k,j,l){trace("Google Docs ERROR");trace("Google Docs ERROR: "+j+" "+k.responseText)}).success(function(j){clearTimeout(a)})}var b,h,d,a,c=0;h=VMM.Timeline.DataObj.model.googlespreadsheet.extractSpreadsheetKey(f);d="https://spreadsheets.google.com/feeds/cells/"+h+"/od6/public/values?alt=json";a=setTimeout(function(){trace("Google Docs timeout "+d);trace(d);if(c<3){VMM.fireEvent(global,VMM.Timeline.Config.events.messege,"Still waiting on Google Docs, trying again "+c);c++;b.abort();g()}else{VMM.fireEvent(global,VMM.Timeline.Config.events.messege,"Google Docs is not responding")}},16000);g()},buildDataCells:function(y){function B(a){return typeof a!="undefined"?a.$t:""}var D=VMM.Timeline.DataObj.data_template_obj,k=!1,b=["timeline"],q=[],E=0,j=0,C=0;VMM.fireEvent(global,VMM.Timeline.Config.events.messege,VMM.Language.messages.loading_timeline+" Parsing Google Doc Data (cells)");if(typeof y.feed.entry!="undefined"){k=!0;for(j=0;j<y.feed.entry.length;j++){var w=y.feed.entry[j];parseInt(w.gs$cell.row)>E&&(E=parseInt(w.gs$cell.row))}for(var j=0;j<E+1;j++){var m={type:"",startDate:"",endDate:"",headline:"",text:"",tag:"",asset:{media:"",credit:"",caption:"",thumbnail:""}};q.push(m)}for(j=0;j<y.feed.entry.length;j++){var w=y.feed.entry[j],A="",v="",g={content:B(w.gs$cell),col:w.gs$cell.col,row:w.gs$cell.row,name:""};if(g.row==1){g.content=="Start Date"?v="startDate":g.content=="End Date"?v="endDate":g.content=="Headline"?v="headline":g.content=="Text"?v="text":g.content=="Media"?v="media":g.content=="Media Credit"?v="credit":g.content=="Media Caption"?v="caption":g.content=="Media Thumbnail"?v="thumbnail":g.content=="Type"?v="type":g.content=="Tag"&&(v="tag");b.push(v)}else{g.name=b[g.col];q[g.row][g.name]=g.content}}for(j=0;j<q.length;j++){var m=q[j];if(m.type.match("start")||m.type.match("title")){D.timeline.startDate=m.startDate;D.timeline.headline=m.headline;D.timeline.asset.media=m.media;D.timeline.asset.caption=m.caption;D.timeline.asset.credit=m.credit;D.timeline.text=m.text;D.timeline.type="google spreadsheet"}else{if(m.type.match("era")){var z={startDate:m.startDate,endDate:m.endDate,headline:m.headline,text:m.text,tag:m.tag};D.timeline.era.push(z)}else{if(m.startDate){var m={type:"google spreadsheet",startDate:m.startDate,endDate:m.endDate,headline:m.headline,text:m.text,tag:m.tag,asset:{media:m.media,credit:m.credit,caption:m.caption,thumbnail:m.thumbnail}};D.timeline.date.push(m)}else{trace("Skipping item "+j+" in list: no start date.")}}}}}k=D.timeline.date.length>0;if(k){VMM.fireEvent(global,VMM.Timeline.Config.events.messege,"Finished Parsing Data");VMM.fireEvent(global,VMM.Timeline.Config.events.data_ready,D)}else{VMM.fireEvent(global,VMM.Timeline.Config.events.messege,"Unable to load Google Doc data source. Make sure you have no blank rows and that the headers have not been changed.")}}},storify:{getData:function(c){var a,d,b;VMM.fireEvent(global,VMM.Timeline.Config.events.messege,"Loading Storify...");a=c.split("storify.com/")[1];d="//api.storify.com/v1/stories/"+a+"?per_page=300&callback=?";b=setTimeout(function(){trace("STORIFY timeout");VMM.fireEvent(global,VMM.Timeline.Config.events.messege,"Storify is not responding")},6000);VMM.getJSON(d,VMM.Timeline.DataObj.model.storify.buildData).error(function(g,f,h){trace("STORIFY error");trace("STORIFY ERROR: "+f+" "+g.responseText)}).success(function(f){clearTimeout(b)})},buildData:function(q){VMM.fireEvent(global,VMM.Timeline.Config.events.messege,"Parsing Data");var z=VMM.Timeline.DataObj.data_template_obj;z.timeline.startDate=new Date(q.content.date.created);z.timeline.headline=q.content.title;trace(q);var g="",b=q.content.author.username,k="";if(typeof q.content.author.name!="undefined"){b=q.content.author.name;k=q.content.author.username+"&nbsp;"}typeof q.content.description!="undefined"&&q.content.description!=null&&(g+=q.content.description);g+="<div class='storify'>";g+="<div class='vcard author'><a class='screen-name url' href='"+q.content.author.permalink+"' target='_blank'>";g+="<span class='avatar'><img src='"+q.content.author.avatar+"' style='max-width: 32px; max-height: 32px;'></span>";g+="<span class='fn'>"+b+"</span>";g+="<span class='nickname'>"+k+"<span class='thumbnail-inline'></span></span>";g+="</a>";g+="</div>";g+="</div>";z.timeline.text=g;z.timeline.asset.media=q.content.thumbnail;z.timeline.type="storify";for(var A=0;A<q.content.elements.length;A++){var d=q.content.elements[A],y=!1,w=new Date(d.posted_at);trace(d.type);var p={type:"storify",startDate:d.posted_at,endDate:d.posted_at,headline:" ",slug:"",text:"",asset:{media:"",credit:"",caption:""}};if(d.type=="image"){if(typeof d.source.name!="undefined"){if(d.source.name=="flickr"){p.asset.media="//flickr.com/photos/"+d.meta.pathalias+"/"+d.meta.id+"/";p.asset.credit="<a href='"+p.asset.media+"'>"+d.attribution.name+"</a>";p.asset.credit+=" on <a href='"+d.source.href+"'>"+d.source.name+"</a>"}else{if(d.source.name=="instagram"){p.asset.media=d.permalink;p.asset.credit="<a href='"+d.permalink+"'>"+d.attribution.name+"</a>";p.asset.credit+=" on <a href='"+d.source.href+"'>"+d.source.name+"</a>"}else{p.asset.credit="<a href='"+d.permalink+"'>"+d.attribution.name+"</a>";typeof d.source.href!="undefined"&&(p.asset.credit+=" on <a href='"+d.source.href+"'>"+d.source.name+"</a>");p.asset.media=d.data.image.src}}}else{p.asset.credit="<a href='"+d.permalink+"'>"+d.attribution.name+"</a>";p.asset.media=d.data.image.src}p.slug=d.attribution.name;if(typeof d.data.image.caption!="undefined"&&d.data.image.caption!="undefined"){p.asset.caption=d.data.image.caption;p.slug=d.data.image.caption}}else{if(d.type=="quote"){if(d.permalink.match("twitter")){p.asset.media=d.permalink;p.slug=VMM.Util.untagify(d.data.quote.text)}else{if(d.permalink.match("storify")){y=!0;p.asset.media="<blockquote>"+d.data.quote.text.replace(/<\s*\/?\s*b\s*.*?>/g,"")+"</blockquote>"}}}else{if(d.type=="link"){p.headline=d.data.link.title;p.text=d.data.link.description;d.data.link.thumbnail!="undefined"&&d.data.link.thumbnail!=""?p.asset.media=d.data.link.thumbnail:p.asset.media=d.permalink;p.asset.caption="<a href='"+d.permalink+"' target='_blank'>"+d.data.link.title+"</a>";p.slug=d.data.link.title}else{if(d.type=="text"){if(d.permalink.match("storify")){y=!0;var j=q.content.author.username,v="";if(typeof d.attribution.name!="undefined"){b=d.attribution.name;k=d.attribution.username+"&nbsp;"}var m="<div class='storify'>";m+="<blockquote><p>"+d.data.text.replace(/<\s*\/?\s*b\s*.*?>/g,"")+"</p></blockquote>";m+="<div class='vcard author'><a class='screen-name url' href='"+d.attribution.href+"' target='_blank'>";m+="<span class='avatar'><img src='"+d.attribution.thumbnail+"' style='max-width: 32px; max-height: 32px;'></span>";m+="<span class='fn'>"+b+"</span>";m+="<span class='nickname'>"+k+"<span class='thumbnail-inline'></span></span>";m+="</a></div></div>";p.text=m;if(A+1>=q.content.elements.length){p.startDate=q.content.elements[A-1].posted_at}else{if(q.content.elements[A+1].type=="text"&&q.content.elements[A+1].permalink.match("storify")){if(A+2>=q.content.elements.length){p.startDate=q.content.elements[A-1].posted_at}else{if(q.content.elements[A+2].type=="text"&&q.content.elements[A+2].permalink.match("storify")){if(A+3>=q.content.elements.length){p.startDate=q.content.elements[A-1].posted_at}else{if(q.content.elements[A+3].type=="text"&&q.content.elements[A+3].permalink.match("storify")){p.startDate=q.content.elements[A-1].posted_at}else{trace("LEVEL 3");p.startDate=q.content.elements[A+3].posted_at}}}else{trace("LEVEL 2");p.startDate=q.content.elements[A+2].posted_at}}}else{trace("LEVEL 1");p.startDate=q.content.elements[A+1].posted_at}}p.endDate=p.startDate}}else{if(d.type=="video"){p.headline=d.data.video.title;p.asset.caption=d.data.video.description;p.asset.caption=d.source.username;p.asset.media=d.data.video.src}else{trace("NO MATCH ");trace(d)}}}}}y&&(p.slug=VMM.Util.untagify(d.data.text));z.timeline.date.push(p)}VMM.fireEvent(global,VMM.Timeline.Config.events.data_ready,z)}},tweets:{type:"twitter",buildData:function(a){VMM.bindEvent(global,VMM.Timeline.DataObj.model.tweets.onTwitterDataReady,"TWEETSLOADED");VMM.ExternalAPI.twitter.getTweets(a.timeline.tweets)},getData:function(a){VMM.bindEvent(global,VMM.Timeline.DataObj.model.tweets.onTwitterDataReady,"TWEETSLOADED");VMM.ExternalAPI.twitter.getTweetSearch(a)},onTwitterDataReady:function(d,b){var f=VMM.Timeline.DataObj.data_template_obj;for(var c=0;c<b.tweetdata.length;c++){var a={type:"tweets",startDate:"",headline:"",text:"",asset:{media:"",credit:"",caption:""},tags:"Optional"};a.startDate=b.tweetdata[c].raw.created_at;type.of(b.tweetdata[c].raw.from_user_name)?a.headline=b.tweetdata[c].raw.from_user_name+" (<a href='https://twitter.com/"+b.tweetdata[c].raw.from_user+"'>@"+b.tweetdata[c].raw.from_user+"</a>)":a.headline=b.tweetdata[c].raw.user.name+" (<a href='https://twitter.com/"+b.tweetdata[c].raw.user.screen_name+"'>@"+b.tweetdata[c].raw.user.screen_name+"</a>)";a.asset.media=b.tweetdata[c].content;f.timeline.date.push(a)}VMM.fireEvent(global,VMM.Timeline.Config.events.data_ready,f)}}},data_template_obj:{timeline:{headline:"",description:"",asset:{media:"",credit:"",caption:""},date:[],era:[]}},date_obj:{startDate:"2012,2,2,11,30",headline:"",text:"",asset:{media:"http://youtu.be/vjVfu8-Wp6s",credit:"",caption:""},tags:"Optional"}});VMM.debug=!1;